<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Analisis Integrado</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="AnalisisIntergrado_files/libs/clipboard/clipboard.min.js"></script>
<script src="AnalisisIntergrado_files/libs/quarto-html/quarto.js"></script>
<script src="AnalisisIntergrado_files/libs/quarto-html/popper.min.js"></script>
<script src="AnalisisIntergrado_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="AnalisisIntergrado_files/libs/quarto-html/anchor.min.js"></script>
<link href="AnalisisIntergrado_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="AnalisisIntergrado_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="AnalisisIntergrado_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="AnalisisIntergrado_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="AnalisisIntergrado_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="AnalisisIntergrado_files/libs/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<link href="AnalisisIntergrado_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="AnalisisIntergrado_files/libs/datatables-binding-0.27/datatables.js"></script>
<script src="AnalisisIntergrado_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="AnalisisIntergrado_files/libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="AnalisisIntergrado_files/libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="AnalisisIntergrado_files/libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
<link href="AnalisisIntergrado_files/libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="AnalisisIntergrado_files/libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#load-data" id="toc-load-data" class="nav-link active" data-scroll-target="#load-data">Load data</a>
  <ul class="collapse">
  <li><a href="#funtional-annotation" id="toc-funtional-annotation" class="nav-link" data-scroll-target="#funtional-annotation">Funtional Annotation</a></li>
  <li><a href="#metadata" id="toc-metadata" class="nav-link" data-scroll-target="#metadata">Metadata</a></li>
  <li><a href="#rna-seq" id="toc-rna-seq" class="nav-link" data-scroll-target="#rna-seq">RNA-Seq</a></li>
  <li><a href="#dna" id="toc-dna" class="nav-link" data-scroll-target="#dna">DNA</a></li>
  </ul></li>
  <li><a href="#analisis" id="toc-analisis" class="nav-link" data-scroll-target="#analisis">Analisis</a>
  <ul class="collapse">
  <li><a href="#rna-seq-1" id="toc-rna-seq-1" class="nav-link" data-scroll-target="#rna-seq-1">RNA-Seq</a>
  <ul class="collapse">
  <li><a href="#heng" id="toc-heng" class="nav-link" data-scroll-target="#heng">Heng</a></li>
  <li><a href="#sg" id="toc-sg" class="nav-link" data-scroll-target="#sg">SG</a></li>
  <li><a href="#slp" id="toc-slp" class="nav-link" data-scroll-target="#slp">SLP</a></li>
  <li><a href="#respuesta-parcial-vs-progresion-de-la-enfermedad" id="toc-respuesta-parcial-vs-progresion-de-la-enfermedad" class="nav-link" data-scroll-target="#respuesta-parcial-vs-progresion-de-la-enfermedad">Respuesta Parcial vs Progresion de la Enfermedad</a></li>
  </ul></li>
  <li><a href="#dna-seq" id="toc-dna-seq" class="nav-link" data-scroll-target="#dna-seq">DNA-Seq</a>
  <ul class="collapse">
  <li><a href="#heng-1" id="toc-heng-1" class="nav-link" data-scroll-target="#heng-1">Heng</a></li>
  <li><a href="#sg-1" id="toc-sg-1" class="nav-link" data-scroll-target="#sg-1">SG</a></li>
  <li><a href="#slp-1" id="toc-slp-1" class="nav-link" data-scroll-target="#slp-1">SLP</a></li>
  <li><a href="#respuesta" id="toc-respuesta" class="nav-link" data-scroll-target="#respuesta">Respuesta</a></li>
  </ul></li>
  <li><a href="#integrado" id="toc-integrado" class="nav-link" data-scroll-target="#integrado">Integrado</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Analisis Integrado</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-1_4ee4cbd7e9c4a20235f01547f101bb84">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"/storage2/RNASeq/integrado/"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggsci)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="load-data" class="level1">
<h1>Load data</h1>
<section id="funtional-annotation" class="level2">
<h2 class="anchored" data-anchor-id="funtional-annotation">Funtional Annotation</h2>
<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-2_17811493b8d1f2a0bc5a09500d138991">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mart <span class="ot">&lt;-</span> biomaRt<span class="sc">::</span><span class="fu">useMart</span>(<span class="at">biomart =</span> <span class="st">"ENSEMBL_MART_ENSEMBL"</span>,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">dataset =</span> <span class="st">"hsapiens_gene_ensembl"</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">host =</span> <span class="st">'https://www.ensembl.org'</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>ttg <span class="ot">&lt;-</span> biomaRt<span class="sc">::</span><span class="fu">getBM</span>(</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">attributes =</span> <span class="fu">c</span>(<span class="st">"ensembl_gene_id"</span>, <span class="st">"external_gene_name"</span>, <span class="st">"description"</span>,<span class="st">"entrezgene_id"</span>),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">mart =</span> mart)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="metadata" class="level2">
<h2 class="anchored" data-anchor-id="metadata">Metadata</h2>
<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-3_d73f03fd74e1e9152cba9d7658931df3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>metadata <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"2023_02_04_BD_PROANG_Enviada_TAG.xlsx"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>metadata2 <span class="ot">&lt;-</span> metadata <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">so_iniciottodt =</span> <span class="fu">as_date</span>(so_iniciottodt)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">so_finttodt =</span> <span class="fu">as_date</span>(so_finttodt)) <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">SLP =</span> so_finttodt <span class="sc">-</span> so_iniciottodt) <span class="sc">%&gt;%</span> </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">so_exitusdt =</span> <span class="fu">as_date</span>(so_exitusdt)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">SG =</span> so_exitusdt <span class="sc">-</span> so_iniciottodt) <span class="sc">%&gt;%</span> </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SG_score =</span> <span class="fu">case_when</span>(<span class="fu">as.numeric</span>(SG)<span class="sc">/</span><span class="dv">30</span> <span class="sc">&lt;=</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">"Bajo"</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">as.numeric</span>(SG)<span class="sc">/</span><span class="dv">30</span> <span class="sc">&gt;</span> <span class="dv">6</span> <span class="sc">&amp;</span> <span class="fu">as.numeric</span>(SG)<span class="sc">/</span><span class="dv">30</span> <span class="sc">&lt;=</span> <span class="dv">26</span> <span class="sc">~</span> <span class="st">"Medio"</span>,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">as.numeric</span>(SG)<span class="sc">/</span><span class="dv">30</span> <span class="sc">&gt;</span> <span class="dv">26</span> <span class="sc">~</span> <span class="st">"Alto"</span>) <span class="sc">%&gt;%</span> <span class="fu">as_factor</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SLP_score =</span> <span class="fu">case_when</span>(<span class="fu">as.numeric</span>(SLP)<span class="sc">/</span><span class="dv">30</span> <span class="sc">&lt;=</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Refractario"</span>,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">as.numeric</span>(SLP)<span class="sc">/</span><span class="dv">30</span> <span class="sc">&gt;</span> <span class="dv">3</span> <span class="sc">&amp;</span> <span class="fu">as.numeric</span>(SLP)<span class="sc">/</span><span class="dv">30</span> <span class="sc">&lt;=</span> <span class="dv">24</span> <span class="sc">~</span> <span class="st">"Largo"</span>,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">as.numeric</span>(SLP)<span class="sc">/</span><span class="dv">30</span> <span class="sc">&gt;</span> <span class="dv">24</span> <span class="sc">~</span> <span class="st">"MuyLargo"</span>) <span class="sc">%&gt;%</span> <span class="fu">as_factor</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Respuesta =</span> <span class="st">`</span><span class="at">Mejor respuesta al tratamiento</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Resp =</span> <span class="fu">case_when</span>(Respuesta <span class="sc">==</span> <span class="st">"RP"</span> <span class="sc">~</span> <span class="st">"RP"</span>,</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>                          Respuesta <span class="sc">==</span> <span class="st">"EE"</span> <span class="sc">~</span> <span class="st">"RP"</span>,</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>                          Respuesta <span class="sc">==</span> <span class="st">"NE"</span> <span class="sc">~</span> <span class="st">"NE"</span>,</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>                          Respuesta <span class="sc">==</span> <span class="st">"PE"</span> <span class="sc">~</span> <span class="st">"PE"</span>) <span class="sc">%&gt;%</span> <span class="fu">as_factor</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Respuesta =</span> <span class="fu">as_factor</span>(Respuesta)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">edad =</span> (<span class="st">`</span><span class="at">Fecha diagnóstico</span><span class="st">`</span> <span class="sc">%&gt;%</span> <span class="fu">as_date</span>() <span class="sc">%&gt;%</span> <span class="fu">year</span>())<span class="sc">-</span> so_nacimentodt) <span class="sc">%&gt;%</span> </span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Paciente,SLP_score,SG_score,<span class="at">motzer =</span> <span class="st">`</span><span class="at">cmotzer 3 categorías</span><span class="st">`</span>,<span class="at">heng =</span> <span class="st">`</span><span class="at">cheng 3 categorías</span><span class="st">`</span>,Respuesta,Resp,Sexo,edad,<span class="at">estadio =</span> <span class="st">`</span><span class="at">Estadío tumor al diagnóstico IV</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Paciente,<span class="fu">c</span>(<span class="st">"Centro"</span>,<span class="st">"Pat"</span>), <span class="at">sep =</span> <span class="st">"-"</span>,<span class="at">remove =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Centro =</span> <span class="fu">as.numeric</span>(Centro)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Pat =</span> <span class="fu">as.numeric</span>(Pat)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(ID,<span class="fu">c</span>(Centro,Pat),<span class="at">sep =</span> <span class="st">"-"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="rna-seq" class="level2">
<h2 class="anchored" data-anchor-id="rna-seq">RNA-Seq</h2>
<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-4_55dcb6b47df4852ab1218cc205008d89">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>count_table <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(<span class="st">"salmon.merged.gene_counts.tsv"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(count_table) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"X"</span>,<span class="st">""</span>,<span class="fu">colnames</span>(count_table)) <span class="sc">%&gt;%</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">."</span>,<span class="st">"-"</span>,.)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>count_long <span class="ot">&lt;-</span> count_table <span class="sc">%&gt;%</span> </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">"Sample"</span>, <span class="at">values_to =</span> <span class="st">"counts"</span>, <span class="fu">c</span>(<span class="sc">-</span>gene_id,<span class="sc">-</span>gene_name)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Sample) <span class="sc">%&gt;%</span> </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TotalCounts =</span> <span class="fu">sum</span>(counts))</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>count_long <span class="sc">%&gt;%</span>  </span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Sample, TotalCounts) <span class="sc">%&gt;%</span> </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TotalCounts)) <span class="sc">+</span> <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="AnalisisIntergrado_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>count_trim <span class="ot">&lt;-</span> count_long <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gene_id,Sample) <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">counts =</span> <span class="fu">sum</span>(counts)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gene_id) <span class="sc">%&gt;%</span> </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TotalGene =</span> <span class="fu">sum</span>(counts)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TotalGene <span class="sc">&gt;</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gene_id) <span class="sc">%&gt;%</span> </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TotalZeros =</span> <span class="fu">sum</span>(counts<span class="sc">==</span><span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TotalZeros <span class="sc">&lt;</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sample =</span> <span class="fu">str_remove</span>(Sample,<span class="st">"_.*"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Sample,<span class="fu">c</span>(<span class="st">"num1"</span>,<span class="st">"num2"</span>,<span class="st">"num3"</span>),<span class="at">sep =</span> <span class="st">"-"</span>, <span class="at">remove =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">num1 =</span> <span class="fu">as.numeric</span>(num1)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">num2 =</span> <span class="fu">as.numeric</span>(num2)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(ID,num1<span class="sc">:</span>num2,<span class="at">sep =</span> <span class="st">"-"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>num3) <span class="sc">%&gt;%</span> </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(metadata2)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>count_trim <span class="sc">%&gt;%</span> </span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">counts =</span> counts<span class="sc">+</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Sample, <span class="at">y =</span> counts)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="AnalisisIntergrado_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="dna" class="level2">
<h2 class="anchored" data-anchor-id="dna">DNA</h2>
<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-5_4586ea2380be647b12ad166a1482e115">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">dir</span>(<span class="at">pattern =</span> <span class="st">"_genes.txt"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> <span class="fu">read_table</span>(<span class="st">"stats.txt"</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="fu">gsub</span>(<span class="st">".R1.fq.gz"</span>,<span class="st">""</span>,file))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> files)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(i,<span class="at">comment =</span> <span class="st">"# "</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  tmp<span class="sc">$</span>sample <span class="ot">=</span> i</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(res,tmp)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>BED <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(<span class="st">"IAA14187_167_Designed.bed"</span>, <span class="at">skip =</span> <span class="dv">1</span>,<span class="at">col_names =</span> F)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(BED) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Chrm"</span>,<span class="st">"Start"</span>,<span class="st">"End"</span>,<span class="st">"ID"</span>,<span class="st">"comment"</span>,<span class="st">"Ann"</span>)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>BED <span class="ot">&lt;-</span> BED <span class="sc">%&gt;%</span> </span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Ann,<span class="fu">c</span>(<span class="st">"GeneId"</span>,<span class="st">"Pool"</span>), <span class="at">sep =</span> <span class="st">";"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GeneId =</span> <span class="fu">str_replace</span>(GeneId,<span class="st">"GENE_ID="</span>,<span class="st">""</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(GeneId) <span class="sc">%&gt;%</span> </span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-6_ac6795fddb92e5d12b9fca08b6d0dfbd">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>DNA_table <span class="ot">&lt;-</span> res <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GeneId,sample) <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">High =</span> <span class="fu">sum</span>(variants_impact_HIGH),<span class="at">Moderate =</span> <span class="fu">sum</span>(variants_impact_MODERATE), <span class="at">Low =</span> <span class="fu">sum</span>(variants_impact_LOW)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">"impact"</span>, <span class="at">values_to =</span> <span class="st">"N"</span>, High<span class="sc">:</span>Low) <span class="sc">%&gt;%</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#unite(Var, c(GeneId,impact)) %&gt;% </span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pivot_wider(names_from = Var, values_from = N, values_fill = 0) %&gt;% </span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="fu">str_remove</span>(sample,<span class="st">"_S</span><span class="sc">\\</span><span class="st">d+.bwa.mutect2.filter_genes.txt"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"snpEff"</span>,sample)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(sample,<span class="fu">c</span>(<span class="st">"num1"</span>,<span class="st">"num2"</span>,<span class="st">"num3"</span>), <span class="at">sep =</span><span class="st">"_"</span>,<span class="at">remove =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">num1 =</span> <span class="fu">as.numeric</span>(num1)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">num2 =</span> <span class="fu">as.numeric</span>(num2)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(ID,num1<span class="sc">:</span>num2, <span class="at">sep =</span> <span class="st">"-"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>num3) <span class="sc">%&gt;%</span> <span class="fu">semi_join</span>(metadata2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="analisis" class="level1">
<h1>Analisis</h1>
<section id="rna-seq-1" class="level2">
<h2 class="anchored" data-anchor-id="rna-seq-1">RNA-Seq</h2>
<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-7_fa6bbb491b788911559c882f67121a86">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DESeq2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Setting count matrix for DE analysis</p>
<section id="heng" class="level3">
<h3 class="anchored" data-anchor-id="heng">Heng</h3>
<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-8_f4833ba18fcfed7f51fd70db414b1c7f">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>table_trim_heng <span class="ot">&lt;-</span> count_trim <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(metadata2 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(ID,heng)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(gene_id,Sample, counts) <span class="sc">%&gt;%</span> </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Sample, <span class="at">values_from =</span> counts) <span class="sc">%&gt;%</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_data_frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"gene_id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>meta_heng <span class="ot">&lt;-</span> count_trim <span class="sc">%&gt;%</span> <span class="fu">select</span>(Sample,ID) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(metadata2 <span class="sc">%&gt;%</span> </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>               dplyr<span class="sc">::</span><span class="fu">select</span>(ID,heng)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"Sample"</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>dds_gene_heng <span class="ot">&lt;-</span> <span class="fu">DESeqDataSetFromMatrix</span>(<span class="at">countData =</span> <span class="fu">round</span>(table_trim_heng), </span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">colData =</span> meta_heng, </span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">design =</span> <span class="sc">~</span> heng)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>dds_gene_heng <span class="ot">&lt;-</span> <span class="fu">DESeq</span>(dds_gene_heng)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="favorable-vs-intermedio" class="level4">
<h4 class="anchored" data-anchor-id="favorable-vs-intermedio">Favorable vs Intermedio</h4>
<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-9_e8b898ea156fd1b0a814a7f4e1f3850f">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>Heng_favorable_intermedio <span class="ot">&lt;-</span> <span class="fu">results</span>(dds_gene_heng, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"heng"</span>,<span class="st">"FAVORABLE"</span>,<span class="st">"INTERMEDIO"</span>)) <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"ensembl_gene_id"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>Heng_favorable_intermedio <span class="ot">&lt;-</span> Heng_favorable_intermedio <span class="sc">%&gt;%</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">fdr =</span> padj) <span class="sc">%&gt;%</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bonferroni =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"bonferroni"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">homl =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"holm"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BY =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"BY"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"ENS"</span>,ensembl_gene_id)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ensembl_gene_id =</span> <span class="fu">str_replace</span>(ensembl_gene_id,<span class="st">"</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">d+"</span>,<span class="st">""</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(ttg)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>Heng_favorable_intermedio <span class="sc">%&gt;%</span> </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> <span class="fu">ifelse</span>(fdr <span class="sc">&lt;</span> <span class="fl">0.05</span>,<span class="st">"Significative"</span>,<span class="st">"No-Significative"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(sig <span class="sc">==</span> <span class="st">"Significative"</span>,external_gene_name,<span class="cn">NA</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> log2FoldChange, <span class="at">y =</span> <span class="sc">-</span><span class="fu">log10</span>(fdr), <span class="at">color =</span> sig, <span class="at">size =</span> <span class="fu">sqrt</span>(baseMean), <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">size =</span> <span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_d3</span>() <span class="sc">+</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Heng_favorable_intermedio"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="AnalisisIntergrado_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>Heng_favorable_intermedio <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fdr <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-860e6ac111dfb1c73601" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-860e6ac111dfb1c73601">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8"],["ENSG00000074211","ENSG00000104164","ENSG00000166377","ENSG00000171914","ENSG00000178927","ENSG00000223756","ENSG00000232098","ENSG00000255717"],[30.4026162670555,19.3031437965582,98.7719288733453,42.6732435437147,67.3159698417742,21.0392648803498,43.3516882112978,13.9778821178794],[-5.11619839133212,-4.87968569764913,-7.36308308975275,-5.34208087156642,-8.37073618627502,-5.68043576129787,-4.82679915152407,-5.20869475395307],[1.53265480928859,1.46569549558686,1.77790686193158,1.64080992143442,1.81288304545972,1.74316213968701,1.39275865115637,1.40964950651631],[-3.33812829890045,-3.32926294195598,-4.14143352917443,-3.25575851400038,-4.61736139418322,-3.2586961545171,-3.46563932488698,-3.69502825338861],[0.000843447944499682,0.000870761551524479,3.45141899944726e-05,0.00113089892472761,3.88650098278776e-06,0.00111925471378238,0.000528972374024134,0.000219862337745327],[0.0320937828990451,0.0320937828990451,0.00445233050928696,0.0324191025088581,0.00100271725355924,0.0324191025088581,0.0272949744996453,0.0189081610460982],[0.217609569680918,0.224656480293316,0.00890466101857393,0.291771922579723,0.00100271725355924,0.288767716155854,0.136474872498227,0.0567244831382945],[0.21339232995842,0.219431910984169,0.00887014682857946,0.282724731181902,0.00100271725355924,0.280932933159377,0.13435898300213,0.0562847584628038],[0.19680267067556,0.19680267067556,0.0273021892655733,0.198797566953002,0.00614877448550301,0.198797566953002,0.167375840188391,0.115946960915799],["PPP2R2C","BLOC1S6","ATP9B","TLN2","CYBC1","TSSC2","ZNF584-DT","SNHG1"],["protein phosphatase 2 regulatory subunit Bgamma [Source:HGNC Symbol;Acc:HGNC:9306]","biogenesis of lysosomal organelles complex 1 subunit 6 [Source:HGNC Symbol;Acc:HGNC:8549]","ATPase phospholipid transporting 9B (putative) [Source:HGNC Symbol;Acc:HGNC:13541]","talin 2 [Source:HGNC Symbol;Acc:HGNC:15447]","cytochrome b-245 chaperone 1 [Source:HGNC Symbol;Acc:HGNC:28672]","tumor suppressing subtransferable candidate 2 (pseudogene) [Source:HGNC Symbol;Acc:HGNC:12384]","ZNF584 divergent transcript [Source:HGNC Symbol;Acc:HGNC:56027]","small nucleolar RNA host gene 1 [Source:HGNC Symbol;Acc:HGNC:32688]"],[5522,26258,374868,83660,79415,null,null,23642]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>ensembl_gene_id<\/th>\n      <th>baseMean<\/th>\n      <th>log2FoldChange<\/th>\n      <th>lfcSE<\/th>\n      <th>stat<\/th>\n      <th>pvalue<\/th>\n      <th>fdr<\/th>\n      <th>bonferroni<\/th>\n      <th>homl<\/th>\n      <th>BY<\/th>\n      <th>external_gene_name<\/th>\n      <th>description<\/th>\n      <th>entrezgene_id<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,13]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="favorable-vs-intermedio-1" class="level4">
<h4 class="anchored" data-anchor-id="favorable-vs-intermedio-1">Favorable vs Intermedio</h4>
<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-10_fcf576f7f412111bd960eea09b9f1dc3">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>Heng_favorable_malo <span class="ot">&lt;-</span> <span class="fu">results</span>(dds_gene_heng, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"heng"</span>,<span class="st">"FAVORABLE"</span>,<span class="st">"MALO"</span>)) <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"ensembl_gene_id"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>Heng_favorable_malo <span class="ot">&lt;-</span> Heng_favorable_malo <span class="sc">%&gt;%</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">fdr =</span> padj) <span class="sc">%&gt;%</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bonferroni =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"bonferroni"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">homl =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"holm"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BY =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"BY"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"ENS"</span>,ensembl_gene_id)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ensembl_gene_id =</span> <span class="fu">str_replace</span>(ensembl_gene_id,<span class="st">"</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">d+"</span>,<span class="st">""</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(ttg)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>Heng_favorable_malo <span class="sc">%&gt;%</span> </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> <span class="fu">ifelse</span>(fdr <span class="sc">&lt;</span> <span class="fl">0.05</span>,<span class="st">"Significative"</span>,<span class="st">"No-Significative"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(sig <span class="sc">==</span> <span class="st">"Significative"</span>,external_gene_name,<span class="cn">NA</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> log2FoldChange, <span class="at">y =</span> <span class="sc">-</span><span class="fu">log10</span>(fdr), <span class="at">color =</span> sig, <span class="at">size =</span> <span class="fu">sqrt</span>(baseMean), <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">size =</span> <span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_d3</span>() <span class="sc">+</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Heng_favorable_malo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="AnalisisIntergrado_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>Heng_favorable_malo <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fdr <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-58c81d81108e00d04e6e" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-58c81d81108e00d04e6e">{"x":{"filter":"none","vertical":false,"data":[["1"],["ENSG00000178927"],[67.3159698417742],[-7.44419559750249],[1.96657060643288],[-3.78536909539463],[0.000153480609842977],[0.0395979973394881],[0.0395979973394881],[0.0395979973394881],[0.242819353964248],["CYBC1"],["cytochrome b-245 chaperone 1 [Source:HGNC Symbol;Acc:HGNC:28672]"],[79415]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>ensembl_gene_id<\/th>\n      <th>baseMean<\/th>\n      <th>log2FoldChange<\/th>\n      <th>lfcSE<\/th>\n      <th>stat<\/th>\n      <th>pvalue<\/th>\n      <th>fdr<\/th>\n      <th>bonferroni<\/th>\n      <th>homl<\/th>\n      <th>BY<\/th>\n      <th>external_gene_name<\/th>\n      <th>description<\/th>\n      <th>entrezgene_id<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,13]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="favorable-vs-intermedio-2" class="level4">
<h4 class="anchored" data-anchor-id="favorable-vs-intermedio-2">Favorable vs Intermedio</h4>
<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-11_16b518c726ed697acc93df85f001ae3f">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>Heng_intermedio_malo <span class="ot">&lt;-</span> <span class="fu">results</span>(dds_gene_heng, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"heng"</span>,<span class="st">"INTERMEDIO"</span>,<span class="st">"MALO"</span>)) <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"ensembl_gene_id"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>Heng_intermedio_malo <span class="ot">&lt;-</span> Heng_intermedio_malo <span class="sc">%&gt;%</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">fdr =</span> padj) <span class="sc">%&gt;%</span> </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bonferroni =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"bonferroni"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">homl =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"holm"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BY =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"BY"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"ENS"</span>,ensembl_gene_id)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ensembl_gene_id =</span> <span class="fu">str_replace</span>(ensembl_gene_id,<span class="st">"</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">d+"</span>,<span class="st">""</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(ttg)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>Heng_intermedio_malo <span class="sc">%&gt;%</span> </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> <span class="fu">ifelse</span>(fdr <span class="sc">&lt;</span> <span class="fl">0.05</span>,<span class="st">"Significative"</span>,<span class="st">"No-Significative"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(sig <span class="sc">==</span> <span class="st">"Significative"</span>,external_gene_name,<span class="cn">NA</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> log2FoldChange, <span class="at">y =</span> <span class="sc">-</span><span class="fu">log10</span>(fdr), <span class="at">color =</span> sig, <span class="at">size =</span> <span class="fu">sqrt</span>(baseMean), <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">size =</span> <span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_d3</span>() <span class="sc">+</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Heng_favorable_malo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="AnalisisIntergrado_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>Heng_intermedio_malo <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fdr <span class="sc">&lt;</span> <span class="fl">0.05</span>)<span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-caceb2479701e6787a43" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-caceb2479701e6787a43">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5"],["ENSG00000074211","ENSG00000133019","ENSG00000163093","ENSG00000185024","ENSG00000238113"],[30.4026162670555,84.6905016239512,25.8443285089081,129.335161889323,99.3542238422208],[3.12363618887676,4.85470361082949,3.47277618578017,3.30128212521765,3.09956858206344],[0.960715050279021,1.1330341206321,0.982828910200063,0.923248558610469,0.816155832478141],[3.25136593620509,4.28469321658304,3.53344936207998,3.57572410422848,3.79776564562682],[0.00114851927162893,1.82991517711692e-05,0.00041017465618152,0.000349259837517991,0.000146006266739816],[0.0493863286800441,0.00472118115696167,0.026456265323708,0.026456265323708,0.0188348084094363],[0.296317972080265,0.00472118115696167,0.105825061294832,0.0901090380796418,0.0376696168188726],[0.29057537572212,0.00472118115696167,0.104594537326288,0.0894105184046058,0.0375236105521327],[0.302842497865307,0.0289508115436536,0.162232781600883,0.162232781600883,0.115497154333584],["PPP2R2C","CHRM3","BBS5","BRF1","LINC01410"],["protein phosphatase 2 regulatory subunit Bgamma [Source:HGNC Symbol;Acc:HGNC:9306]","cholinergic receptor muscarinic 3 [Source:HGNC Symbol;Acc:HGNC:1952]","Bardet-Biedl syndrome 5 [Source:HGNC Symbol;Acc:HGNC:970]","BRF1 RNA polymerase III transcription initiation factor subunit [Source:HGNC Symbol;Acc:HGNC:11551]","long intergenic non-protein coding RNA 1410 [Source:HGNC Symbol;Acc:HGNC:50702]"],[5522,1131,129880,2972,103352539]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>ensembl_gene_id<\/th>\n      <th>baseMean<\/th>\n      <th>log2FoldChange<\/th>\n      <th>lfcSE<\/th>\n      <th>stat<\/th>\n      <th>pvalue<\/th>\n      <th>fdr<\/th>\n      <th>bonferroni<\/th>\n      <th>homl<\/th>\n      <th>BY<\/th>\n      <th>external_gene_name<\/th>\n      <th>description<\/th>\n      <th>entrezgene_id<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,13]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="sg" class="level3">
<h3 class="anchored" data-anchor-id="sg">SG</h3>
<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-12_36fa25dc819affeea0ecf087099b766f">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>table_trim_SG_SLP_Resp <span class="ot">&lt;-</span> count_trim <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(metadata2 <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>               dplyr<span class="sc">::</span><span class="fu">select</span>(ID,Paciente,SG_score, SLP_score, Resp)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(gene_id,Sample, counts) <span class="sc">%&gt;%</span> </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Sample, <span class="at">values_from =</span> counts) <span class="sc">%&gt;%</span> </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_data_frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"gene_id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>meta_SG_SLP_Resp <span class="ot">&lt;-</span> count_trim <span class="sc">%&gt;%</span> <span class="fu">select</span>(Sample,ID) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(metadata2 <span class="sc">%&gt;%</span> </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>               dplyr<span class="sc">::</span><span class="fu">select</span>(ID,SG_score,SLP_score,Resp)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"Sample"</span>)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>dds_gene_SG_SLP_Resp <span class="ot">&lt;-</span> <span class="fu">DESeqDataSetFromMatrix</span>(<span class="at">countData =</span> <span class="fu">round</span>(table_trim_SG_SLP_Resp), </span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">colData =</span> meta_SG_SLP_Resp, </span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">design =</span> <span class="sc">~</span> SG_score <span class="sc">+</span> SLP_score <span class="sc">+</span> Resp)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>dds_gene_SG_SLP_Resp <span class="ot">&lt;-</span> <span class="fu">DESeq</span>(dds_gene_SG_SLP_Resp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="bajo-vs-medio" class="level4">
<h4 class="anchored" data-anchor-id="bajo-vs-medio">Bajo vs Medio</h4>
<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-13_26ccccc88928f1a77cfd34402db4a49d">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>SG_bajo_medio <span class="ot">&lt;-</span> <span class="fu">results</span>(dds_gene_SG_SLP_Resp, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"SG_score"</span>,<span class="st">"Bajo"</span>,<span class="st">"Medio"</span>))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>SG_bajo_medio <span class="ot">&lt;-</span> SG_bajo_medio <span class="sc">%&gt;%</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"ensembl_gene_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">fdr =</span> padj) <span class="sc">%&gt;%</span> </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bonferroni =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"bonferroni"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">homl =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"holm"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BY =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"BY"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"ENS"</span>,ensembl_gene_id)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ensembl_gene_id =</span> <span class="fu">str_replace</span>(ensembl_gene_id,<span class="st">"</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">d+"</span>,<span class="st">""</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(ttg)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>SG_bajo_medio <span class="sc">%&gt;%</span> </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> <span class="fu">ifelse</span>(fdr <span class="sc">&lt;</span> <span class="fl">0.05</span>,<span class="st">"Significative"</span>,<span class="st">"No-Significative"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(sig <span class="sc">==</span> <span class="st">"Significative"</span>,external_gene_name,<span class="cn">NA</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> log2FoldChange, <span class="at">y =</span> <span class="sc">-</span><span class="fu">log10</span>(fdr), <span class="at">color =</span> sig, <span class="at">size =</span> <span class="fu">sqrt</span>(baseMean), <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">size =</span> <span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_d3</span>() <span class="sc">+</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"SG_bajo_medio"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="AnalisisIntergrado_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>SG_bajo_medio <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fdr <span class="sc">&lt;</span> <span class="fl">0.05</span>)<span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-152745da3bdf1891f591" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-152745da3bdf1891f591">{"x":{"filter":"none","vertical":false,"data":[["1"],["ENSG00000163093"],[25.1759245148719],[-4.85951518938205],[0.928520979330637],[-5.23360839179448],[1.66232450595486e-07],[4.33866696054219e-05],[4.33866696054219e-05],[4.33866696054219e-05],[0.000266552536919175],["BBS5"],["Bardet-Biedl syndrome 5 [Source:HGNC Symbol;Acc:HGNC:970]"],[129880]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>ensembl_gene_id<\/th>\n      <th>baseMean<\/th>\n      <th>log2FoldChange<\/th>\n      <th>lfcSE<\/th>\n      <th>stat<\/th>\n      <th>pvalue<\/th>\n      <th>fdr<\/th>\n      <th>bonferroni<\/th>\n      <th>homl<\/th>\n      <th>BY<\/th>\n      <th>external_gene_name<\/th>\n      <th>description<\/th>\n      <th>entrezgene_id<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,13]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="bajo-vs-alto" class="level4">
<h4 class="anchored" data-anchor-id="bajo-vs-alto">Bajo vs Alto</h4>
<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-14_b930e98552c37e7f3cfebab7f93f50e5">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>SG_bajo_alto <span class="ot">&lt;-</span> <span class="fu">results</span>(dds_gene_SG_SLP_Resp, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"SG_score"</span>,<span class="st">"Bajo"</span>,<span class="st">"Alto"</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>SG_bajo_alto <span class="ot">&lt;-</span> SG_bajo_alto <span class="sc">%&gt;%</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"ensembl_gene_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">fdr =</span> padj) <span class="sc">%&gt;%</span> </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bonferroni =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"bonferroni"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">homl =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"holm"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BY =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"BY"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"ENS"</span>,ensembl_gene_id)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ensembl_gene_id =</span> <span class="fu">str_replace</span>(ensembl_gene_id,<span class="st">"</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">d+"</span>,<span class="st">""</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(ttg)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>SG_bajo_alto <span class="sc">%&gt;%</span> </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> <span class="fu">ifelse</span>(fdr <span class="sc">&lt;</span> <span class="fl">0.05</span>,<span class="st">"Significative"</span>,<span class="st">"No-Significative"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(sig <span class="sc">==</span> <span class="st">"Significative"</span>,external_gene_name,<span class="cn">NA</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> log2FoldChange, <span class="at">y =</span> <span class="sc">-</span><span class="fu">log10</span>(fdr), <span class="at">color =</span> sig, <span class="at">size =</span> <span class="fu">sqrt</span>(baseMean), <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">size =</span> <span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_d3</span>() <span class="sc">+</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"SG_bajo_alto"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="AnalisisIntergrado_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>SG_bajo_alto <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fdr <span class="sc">&lt;</span> <span class="fl">0.05</span>)<span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-8d6533da2a8da1c19fd0" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8d6533da2a8da1c19fd0">{"x":{"filter":"none","vertical":false,"data":[["1","2"],["ENSG00000074211","ENSG00000249348"],[31.5068652467294,50.0488070486315],[-5.64838178490665,-5.13779342700571],[1.34668863616505,1.39135732241654],[-4.19427448425754,-3.69264842627361],[2.73746340703204e-05,0.000221930734751414],[0.00714477949235363,0.0289619608850596],[0.00714477949235363,0.0579239217701191],[0.00714477949235363,0.0577019910353677],[0.0438950285130196,0.177932167144302],["PPP2R2C","UGDH-AS1"],["protein phosphatase 2 regulatory subunit Bgamma [Source:HGNC Symbol;Acc:HGNC:9306]","UGDH antisense RNA 1 [Source:HGNC Symbol;Acc:HGNC:40601]"],[5522,100885776]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>ensembl_gene_id<\/th>\n      <th>baseMean<\/th>\n      <th>log2FoldChange<\/th>\n      <th>lfcSE<\/th>\n      <th>stat<\/th>\n      <th>pvalue<\/th>\n      <th>fdr<\/th>\n      <th>bonferroni<\/th>\n      <th>homl<\/th>\n      <th>BY<\/th>\n      <th>external_gene_name<\/th>\n      <th>description<\/th>\n      <th>entrezgene_id<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,13]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="medio-vs-alto" class="level4">
<h4 class="anchored" data-anchor-id="medio-vs-alto">Medio vs Alto</h4>
<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-15_121160cbba32350cff2b1be6a74dbe32">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>SG_medio_alto <span class="ot">&lt;-</span> <span class="fu">results</span>(dds_gene_SG_SLP_Resp, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"SG_score"</span>,<span class="st">"Medio"</span>,<span class="st">"Alto"</span>))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>SG_medio_alto <span class="ot">&lt;-</span> SG_medio_alto <span class="sc">%&gt;%</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"ensembl_gene_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">fdr =</span> padj) <span class="sc">%&gt;%</span> </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bonferroni =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"bonferroni"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">homl =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"holm"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BY =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"BY"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"ENS"</span>,ensembl_gene_id)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ensembl_gene_id =</span> <span class="fu">str_replace</span>(ensembl_gene_id,<span class="st">"</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">d+"</span>,<span class="st">""</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(ttg)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>SG_medio_alto <span class="sc">%&gt;%</span> </span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> <span class="fu">ifelse</span>(fdr <span class="sc">&lt;</span> <span class="fl">0.05</span>,<span class="st">"Significative"</span>,<span class="st">"No-Significative"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(sig <span class="sc">==</span> <span class="st">"Significative"</span>,external_gene_name,<span class="cn">NA</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> log2FoldChange, <span class="at">y =</span> <span class="sc">-</span><span class="fu">log10</span>(fdr), <span class="at">color =</span> sig, <span class="at">size =</span> <span class="fu">sqrt</span>(baseMean), <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">size =</span> <span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_d3</span>() <span class="sc">+</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"SG_medio_alto"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="AnalisisIntergrado_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>SG_medio_alto <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fdr <span class="sc">&lt;</span> <span class="fl">0.05</span>)<span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-a624f19ab6559b7c0ef9" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a624f19ab6559b7c0ef9">{"x":{"filter":"none","vertical":false,"data":[[],[],[],[],[],[],[],[],[],[],[],[],[],[]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>ensembl_gene_id<\/th>\n      <th>baseMean<\/th>\n      <th>log2FoldChange<\/th>\n      <th>lfcSE<\/th>\n      <th>stat<\/th>\n      <th>pvalue<\/th>\n      <th>fdr<\/th>\n      <th>bonferroni<\/th>\n      <th>homl<\/th>\n      <th>BY<\/th>\n      <th>external_gene_name<\/th>\n      <th>description<\/th>\n      <th>entrezgene_id<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,13]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="slp" class="level3">
<h3 class="anchored" data-anchor-id="slp">SLP</h3>
<section id="refractario-vs-largo" class="level4">
<h4 class="anchored" data-anchor-id="refractario-vs-largo">Refractario vs Largo</h4>
<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-16_62a618f8088f947a27e87e7d955d5aaf">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>SLP_refractario_largo <span class="ot">&lt;-</span> <span class="fu">results</span>(dds_gene_SG_SLP_Resp, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"SLP_score"</span>,<span class="st">"Refractario"</span>,<span class="st">"Largo"</span>))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>SLP_refractario_largo <span class="ot">&lt;-</span> SLP_refractario_largo <span class="sc">%&gt;%</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"ensembl_gene_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">fdr =</span> padj) <span class="sc">%&gt;%</span> </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bonferroni =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"bonferroni"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">homl =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"holm"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BY =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"BY"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"ENS"</span>,ensembl_gene_id)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ensembl_gene_id =</span> <span class="fu">str_replace</span>(ensembl_gene_id,<span class="st">"</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">d+"</span>,<span class="st">""</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(ttg)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>SLP_refractario_largo <span class="sc">%&gt;%</span> </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> <span class="fu">ifelse</span>(fdr <span class="sc">&lt;</span> <span class="fl">0.05</span>,<span class="st">"Significative"</span>,<span class="st">"No-Significative"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(sig <span class="sc">==</span> <span class="st">"Significative"</span>,external_gene_name,<span class="cn">NA</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> log2FoldChange, <span class="at">y =</span> <span class="sc">-</span><span class="fu">log10</span>(fdr), <span class="at">color =</span> sig, <span class="at">size =</span> <span class="fu">sqrt</span>(baseMean), <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">size =</span> <span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_d3</span>() <span class="sc">+</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"SLP_refractario_largo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="AnalisisIntergrado_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>SLP_refractario_largo <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fdr <span class="sc">&lt;</span> <span class="fl">0.05</span>)<span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-1bb25a6d6eef569aa977" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1bb25a6d6eef569aa977">{"x":{"filter":"none","vertical":false,"data":[["1"],["ENSG00000232233"],[8.42828747889704],[-3.29028132306392],[0.788151620987959],[-4.17468065210538],[2.98404347642341e-05],[0.00778835347346509],[0.00778835347346509],[0.00778835347346509],[0.0478489221610122],["LINC02043"],["long intergenic non-protein coding RNA 2043 [Source:HGNC Symbol;Acc:HGNC:52883]"],[102724699]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>ensembl_gene_id<\/th>\n      <th>baseMean<\/th>\n      <th>log2FoldChange<\/th>\n      <th>lfcSE<\/th>\n      <th>stat<\/th>\n      <th>pvalue<\/th>\n      <th>fdr<\/th>\n      <th>bonferroni<\/th>\n      <th>homl<\/th>\n      <th>BY<\/th>\n      <th>external_gene_name<\/th>\n      <th>description<\/th>\n      <th>entrezgene_id<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,13]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="refractario-vs-muylargo" class="level4">
<h4 class="anchored" data-anchor-id="refractario-vs-muylargo">Refractario vs MuyLargo</h4>
<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-17_8d71c17a9af5cee3895f83f594740559">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>SLP_refractario_muyLargo <span class="ot">&lt;-</span> <span class="fu">results</span>(dds_gene_SG_SLP_Resp, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"SLP_score"</span>,<span class="st">"Refractario"</span>,<span class="st">"MuyLargo"</span>))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>SLP_refractario_muyLargo <span class="ot">&lt;-</span> SLP_refractario_muyLargo <span class="sc">%&gt;%</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"ensembl_gene_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">fdr =</span> padj) <span class="sc">%&gt;%</span> </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bonferroni =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"bonferroni"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">homl =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"holm"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BY =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"BY"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"ENS"</span>,ensembl_gene_id)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ensembl_gene_id =</span> <span class="fu">str_replace</span>(ensembl_gene_id,<span class="st">"</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">d+"</span>,<span class="st">""</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(ttg)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>SLP_refractario_muyLargo <span class="sc">%&gt;%</span> </span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> <span class="fu">ifelse</span>(fdr <span class="sc">&lt;</span> <span class="fl">0.05</span>,<span class="st">"Significative"</span>,<span class="st">"No-Significative"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(sig <span class="sc">==</span> <span class="st">"Significative"</span>,external_gene_name,<span class="cn">NA</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> log2FoldChange, <span class="at">y =</span> <span class="sc">-</span><span class="fu">log10</span>(fdr), <span class="at">color =</span> sig, <span class="at">size =</span> <span class="fu">sqrt</span>(baseMean), <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">size =</span> <span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_d3</span>() <span class="sc">+</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"SLP_refractario_muyLargo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="AnalisisIntergrado_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>SLP_refractario_muyLargo <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fdr <span class="sc">&lt;</span> <span class="fl">0.05</span>)<span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-cac1d3c4e1dec0990dad" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-cac1d3c4e1dec0990dad">{"x":{"filter":"none","vertical":false,"data":[[],[],[],[],[],[],[],[],[],[],[],[],[],[]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>ensembl_gene_id<\/th>\n      <th>baseMean<\/th>\n      <th>log2FoldChange<\/th>\n      <th>lfcSE<\/th>\n      <th>stat<\/th>\n      <th>pvalue<\/th>\n      <th>fdr<\/th>\n      <th>bonferroni<\/th>\n      <th>homl<\/th>\n      <th>BY<\/th>\n      <th>external_gene_name<\/th>\n      <th>description<\/th>\n      <th>entrezgene_id<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,13]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="largo-vs-muylargo" class="level4">
<h4 class="anchored" data-anchor-id="largo-vs-muylargo">Largo vs MuyLargo</h4>
<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-18_423b1b12d46318396c977329676547ac">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>SLP_largo_muyLargo <span class="ot">&lt;-</span> <span class="fu">results</span>(dds_gene_SG_SLP_Resp, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"SLP_score"</span>,<span class="st">"Largo"</span>,<span class="st">"MuyLargo"</span>))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>SLP_largo_muyLargo <span class="ot">&lt;-</span> SLP_largo_muyLargo <span class="sc">%&gt;%</span> </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"ensembl_gene_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">fdr =</span> padj) <span class="sc">%&gt;%</span> </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bonferroni =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"bonferroni"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">homl =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"holm"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BY =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"BY"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"ENS"</span>,ensembl_gene_id)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ensembl_gene_id =</span> <span class="fu">str_replace</span>(ensembl_gene_id,<span class="st">"</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">d+"</span>,<span class="st">""</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(ttg)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>SLP_largo_muyLargo <span class="sc">%&gt;%</span> </span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> <span class="fu">ifelse</span>(fdr <span class="sc">&lt;</span> <span class="fl">0.05</span>,<span class="st">"Significative"</span>,<span class="st">"No-Significative"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(sig <span class="sc">==</span> <span class="st">"Significative"</span>,external_gene_name,<span class="cn">NA</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> log2FoldChange, <span class="at">y =</span> <span class="sc">-</span><span class="fu">log10</span>(fdr), <span class="at">color =</span> sig, <span class="at">size =</span> <span class="fu">sqrt</span>(baseMean), <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">size =</span> <span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_d3</span>() <span class="sc">+</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"SLP_largo_muyLargo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="AnalisisIntergrado_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>SLP_largo_muyLargo <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fdr <span class="sc">&lt;</span> <span class="fl">0.05</span>)<span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-067565a43fc4312ee418" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-067565a43fc4312ee418">{"x":{"filter":"none","vertical":false,"data":[[],[],[],[],[],[],[],[],[],[],[],[],[],[]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>ensembl_gene_id<\/th>\n      <th>baseMean<\/th>\n      <th>log2FoldChange<\/th>\n      <th>lfcSE<\/th>\n      <th>stat<\/th>\n      <th>pvalue<\/th>\n      <th>fdr<\/th>\n      <th>bonferroni<\/th>\n      <th>homl<\/th>\n      <th>BY<\/th>\n      <th>external_gene_name<\/th>\n      <th>description<\/th>\n      <th>entrezgene_id<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,13]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="respuesta-parcial-vs-progresion-de-la-enfermedad" class="level3">
<h3 class="anchored" data-anchor-id="respuesta-parcial-vs-progresion-de-la-enfermedad">Respuesta Parcial vs Progresion de la Enfermedad</h3>
<section id="rp-vs-pe" class="level4">
<h4 class="anchored" data-anchor-id="rp-vs-pe">RP vs PE</h4>
<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-19_cbaeed364a70a83bae37df9fe1f5027c">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>Resp_RP_PE <span class="ot">&lt;-</span> <span class="fu">results</span>(dds_gene_SG_SLP_Resp, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"Resp"</span>,<span class="st">"RP"</span>,<span class="st">"PE"</span>))</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>Resp_RP_PE <span class="ot">&lt;-</span> Resp_RP_PE <span class="sc">%&gt;%</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"ensembl_gene_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">fdr =</span> padj) <span class="sc">%&gt;%</span> </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bonferroni =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"bonferroni"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">homl =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"holm"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BY =</span> <span class="fu">p.adjust</span>(pvalue, <span class="at">method =</span> <span class="st">"BY"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"ENS"</span>,ensembl_gene_id)) <span class="sc">%&gt;%</span> </span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ensembl_gene_id =</span> <span class="fu">str_replace</span>(ensembl_gene_id,<span class="st">"</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">d+"</span>,<span class="st">""</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(ttg)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>Resp_RP_PE <span class="sc">%&gt;%</span> </span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig =</span> <span class="fu">ifelse</span>(fdr <span class="sc">&lt;</span> <span class="fl">0.05</span>,<span class="st">"Significative"</span>,<span class="st">"No-Significative"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(sig <span class="sc">==</span> <span class="st">"Significative"</span>,external_gene_name,<span class="cn">NA</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> log2FoldChange, <span class="at">y =</span> <span class="sc">-</span><span class="fu">log10</span>(fdr), <span class="at">color =</span> sig, <span class="at">size =</span> <span class="fu">sqrt</span>(baseMean), <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">size =</span> <span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_d3</span>() <span class="sc">+</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Resp_RP_PE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="AnalisisIntergrado_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>Resp_RP_PE <span class="sc">%&gt;%</span> <span class="fu">filter</span>(fdr <span class="sc">&lt;</span> <span class="fl">0.05</span>)<span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-775a27dc4b80689a86b2" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-775a27dc4b80689a86b2">{"x":{"filter":"none","vertical":false,"data":[["1","2","3"],["ENSG00000061455","ENSG00000155158","ENSG00000198763"],[157.289969896115,55.8273231423011,594.530869932183],[3.93746258398788,-4.20469253358287,2.52247176041297],[1.08836976037405,1.02199276116992,0.676091893676642],[3.61776183733242,-4.11420970219942,3.7309599242428],[0.000297161646408503,3.88508136563301e-05,0.000190751568586096],[0.0258530632375398,0.0101400623643021,0.0248930797004855],[0.0775591897126193,0.0101400623643021,0.049786159400971],[0.0769648664198023,0.0101400623643021,0.0495954078323849],[0.158832186378207,0.0622969997998098,0.152934382985377],["PRDM6","TTC39B","MT-ND2"],["PR/SET domain 6 [Source:HGNC Symbol;Acc:HGNC:9350]","tetratricopeptide repeat domain 39B [Source:HGNC Symbol;Acc:HGNC:23704]","mitochondrially encoded NADH:ubiquinone oxidoreductase core subunit 2 [Source:HGNC Symbol;Acc:HGNC:7456]"],[93166,158219,4536]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>ensembl_gene_id<\/th>\n      <th>baseMean<\/th>\n      <th>log2FoldChange<\/th>\n      <th>lfcSE<\/th>\n      <th>stat<\/th>\n      <th>pvalue<\/th>\n      <th>fdr<\/th>\n      <th>bonferroni<\/th>\n      <th>homl<\/th>\n      <th>BY<\/th>\n      <th>external_gene_name<\/th>\n      <th>description<\/th>\n      <th>entrezgene_id<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,13]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
</section>
<section id="dna-seq" class="level2">
<h2 class="anchored" data-anchor-id="dna-seq">DNA-Seq</h2>
<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-20_d8f7e1e23d1475503d70163e5a8dbc33">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelbased)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>DNA_test <span class="ot">&lt;-</span> DNA_table <span class="sc">%&gt;%</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(BED) <span class="sc">%&gt;%</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GeneId,sample,ID) <span class="sc">%&gt;%</span> </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Mutations =</span> <span class="fu">sum</span>(N)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(metadata2) <span class="sc">%&gt;%</span> </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(SLP_score<span class="sc">:</span>Sexo,estadio),as_factor) <span class="sc">%&gt;%</span> </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest_by</span>(GeneId) <span class="sc">%&gt;%</span> </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">test =</span> <span class="fu">list</span>(<span class="fu">glm</span>(Mutations <span class="sc">~</span> SLP_score <span class="sc">+</span> SG_score <span class="sc">+</span> Resp <span class="sc">+</span> heng, <span class="at">data =</span> data, <span class="at">family =</span> poisson)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="heng-1" class="level3">
<h3 class="anchored" data-anchor-id="heng-1">Heng</h3>
<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-21_d55553de0da4b33cdf830cf1a4608430">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>DNA_test <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">res =</span> <span class="fu">list</span>(<span class="fu">estimate_contrasts</span>(test,<span class="at">contrast =</span> <span class="st">"heng"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(res) <span class="sc">%&gt;%</span> </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>test,<span class="sc">-</span>data) <span class="sc">%&gt;%</span> </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">padj =</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">"fdr"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(padj <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-e6787a43152745da3bdf" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e6787a43152745da3bdf">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81"],["ABL1","ABL1","ABL2","ABL2","AKT1","AKT1","APC","APC","APC","ARID1B","ARID1B","ATM","ATM","BLM","BRAF","BRAF","BRCA1","BRCA1","BRCA1","CDKN1A","CDKN1A","CHEK2","CHEK2","CSF1R","EGFR","EGFR","ERBB4","ERBB4","FANCA","FANCB","FANCB","FGFR1","FGFR1","FGFR3","FGFR3","FGFR3","GNAS","GRIN2A","HRAS","IDH1","IDH1","JAK1","JAK1","KDM5C","KMT2C","KRAS","KRAS","LRP1B","LRP1B","LRP1B","MDM2","MDM2","MSH6","NEDD4","NEDD4","NEDD4","NPM1","NPM1","NPM1","PBRM1","PBRM1","PBRM1","PDXDC1","PDXDC1","PTK2","PTK2","PTK2","RANBP2","RANBP2","RB1","RB1","ROS1","TERT","TERT","TP53","TP53","TP53BP1","TSC1","TSC1","TSC2","TSC2"],["FAVORABLE","MALO","FAVORABLE","FAVORABLE","FAVORABLE","MALO","FAVORABLE","FAVORABLE","MALO","FAVORABLE","FAVORABLE","FAVORABLE","FAVORABLE","MALO","FAVORABLE","FAVORABLE","FAVORABLE","FAVORABLE","MALO","FAVORABLE","FAVORABLE","FAVORABLE","MALO","FAVORABLE","FAVORABLE","FAVORABLE","FAVORABLE","MALO","MALO","FAVORABLE","MALO","FAVORABLE","MALO","FAVORABLE","FAVORABLE","MALO","MALO","MALO","MALO","FAVORABLE","FAVORABLE","FAVORABLE","MALO","FAVORABLE","MALO","FAVORABLE","MALO","FAVORABLE","FAVORABLE","MALO","FAVORABLE","MALO","FAVORABLE","FAVORABLE","FAVORABLE","MALO","FAVORABLE","FAVORABLE","MALO","FAVORABLE","FAVORABLE","MALO","FAVORABLE","MALO","FAVORABLE","FAVORABLE","MALO","FAVORABLE","FAVORABLE","FAVORABLE","MALO","FAVORABLE","FAVORABLE","MALO","FAVORABLE","FAVORABLE","FAVORABLE","FAVORABLE","FAVORABLE","FAVORABLE","FAVORABLE"],["INTERMEDIO","INTERMEDIO","INTERMEDIO","MALO","MALO","INTERMEDIO","INTERMEDIO","MALO","INTERMEDIO","INTERMEDIO","MALO","INTERMEDIO","MALO","INTERMEDIO","INTERMEDIO","MALO","INTERMEDIO","MALO","INTERMEDIO","INTERMEDIO","MALO","INTERMEDIO","INTERMEDIO","INTERMEDIO","INTERMEDIO","MALO","INTERMEDIO","INTERMEDIO","INTERMEDIO","INTERMEDIO","INTERMEDIO","INTERMEDIO","INTERMEDIO","INTERMEDIO","MALO","INTERMEDIO","INTERMEDIO","INTERMEDIO","INTERMEDIO","INTERMEDIO","MALO","INTERMEDIO","INTERMEDIO","INTERMEDIO","INTERMEDIO","MALO","INTERMEDIO","INTERMEDIO","MALO","INTERMEDIO","INTERMEDIO","INTERMEDIO","INTERMEDIO","INTERMEDIO","MALO","INTERMEDIO","INTERMEDIO","MALO","INTERMEDIO","INTERMEDIO","MALO","INTERMEDIO","MALO","INTERMEDIO","INTERMEDIO","MALO","INTERMEDIO","INTERMEDIO","MALO","INTERMEDIO","INTERMEDIO","INTERMEDIO","MALO","INTERMEDIO","INTERMEDIO","MALO","INTERMEDIO","INTERMEDIO","MALO","INTERMEDIO","MALO"],[0.188450324076932,0.175686184141105,0.307737105666932,0.236579875328513,0.287192019735665,-0.181861784337635,0.155430213728909,0.0812824126386854,0.0741478010902235,0.0931337524236674,0.119951414779017,0.165924808369968,0.180568727716292,0.142943012766906,0.279633107066877,0.251871591553106,0.302755744528025,0.201542732005234,0.101213012522791,0.650654766335319,0.556483016811123,0.372559646492052,0.394394916268066,0.272247787464441,0.228841904245914,0.178219406793236,0.392405123161097,0.235886828613548,0.132820783366925,0.211663825412297,0.283756709571892,0.13138719987382,0.0804115608245551,-0.122495818883352,-0.263476805797969,0.140980986914616,-0.109568909187688,0.18260822788061,-0.266473882189063,0.447992787330832,0.383261183838332,0.152710817906742,0.15090829885582,0.113267954717009,0.109216557176428,-0.463921545206201,0.524954299395616,0.251426701522427,0.15437635383369,0.0970503476887366,0.324113981045664,0.247037128633157,0.204997417600721,0.310771130358663,0.201502546623349,0.109268583735314,0.349647205644436,0.604094354216122,-0.254447148571686,0.31133659464028,0.280414862503547,0.0309217321367329,-0.132793089595332,0.151120504299561,0.0867304585246785,-0.0791914707061644,0.165921929230843,0.227840036003102,0.204746484309989,0.386247669863455,0.368833988743621,0.250875185187796,0.282565718960386,-0.145890505605812,-0.202121260003286,-0.247599818059973,0.154549266168958,0.384591120513903,0.308602259331983,0.130287383173866,0.158721824508623],[0.019567683107325,0.0482400907877988,0.197866471391654,0.110514028269648,0.0728367491446078,-0.326869654350352,0.113173254608298,0.0337231426095662,0.0427738122158353,0.00969897401416164,0.0249996303496855,0.031044303611626,0.0270642724349534,0.0477719957294978,0.0797696588259083,0.0287160966725384,0.197448448953557,0.0829616284387496,0.0210100747191648,0.390641808240826,0.243807987072511,0.131250305506384,0.20087237635745,0.103217193244799,0.14870687609644,0.0869348888022351,0.192848226230195,0.0820530546052445,0.0276234624891546,0.00346714970358217,0.130407405741997,0.0320037114465902,0.00539459855121137,-0.259498062205146,-0.41383287498233,0.0501382751403244,-0.199628386988944,0.0749867226694344,-0.467954988779172,0.166370551059505,0.0585477429613282,0.0586976292197885,0.0786599051446738,0.03812080790053,0.018320331863827,-0.825908763653724,0.306547472754667,0.122246481938945,0.00736650764952201,-0.00404344327742992,0.125397325545315,0.0892693293432387,0.0551502990339295,0.217992519103747,0.0956969853916085,0.036016988519379,0.13680815366929,0.350736701925438,-0.43271358179352,0.264094559185605,0.226658948721538,-0.00584720732787237,-0.232433278488125,0.0890246598276759,0.0385650619072413,-0.132878707304562,0.130422649003095,0.0577166600090228,0.0109372982944509,0.0186644286948558,0.0953991936882954,0.0643833701431594,0.0714758900294685,-0.285992172369817,-0.331346205120296,-0.390855351184402,0.0539236389144892,0.261581885645657,0.166858743183038,0.065264313837548,0.0847965515872426],[0.357332965046538,0.303132277494412,0.41760773994221,0.362645722387378,0.501547290326723,-0.0368539143249188,0.19768717284952,0.128841682667805,0.105521789964612,0.176568530833173,0.214903199208349,0.300805313128309,0.334073182997631,0.238114029804315,0.479496555307846,0.475027086433673,0.408063040102494,0.320123835571719,0.181415950326418,0.910667724429812,0.869158046549736,0.61386898747772,0.587917456178681,0.441278381684084,0.308976932395388,0.269503924784236,0.591962020092,0.389720602621851,0.238018104244696,0.419860501121013,0.437106013401788,0.230770688301051,0.155428523097899,0.0145064244384416,-0.113120736613607,0.231823698688908,-0.0195094313864327,0.290229733091786,-0.0649927755989551,0.729615023602158,0.707974624715336,0.246724006593695,0.223156692566967,0.188415101533489,0.200112782489029,-0.101934326758678,0.743361126036565,0.380606921105909,0.301386200017858,0.198144138654903,0.522830636546012,0.404804927923075,0.354844536167513,0.403549741613578,0.307308107855089,0.182520178951249,0.562486257619581,0.857452006506806,-0.0761807153498527,0.358578630094955,0.334170776285556,0.0676906716013382,-0.0331529007025379,0.213216348771446,0.134895855142116,-0.0255042341077665,0.201421209458591,0.397963411997182,0.398555670325527,0.753830911032054,0.642268783798947,0.437367000232432,0.493655547891304,-0.00578883884180761,-0.0728963148862755,-0.104344284935544,0.255174893423428,0.50760035538215,0.450345775480929,0.195310452510184,0.232647097430004],[0.0705447226340046,0.0532360771644641,0.0458945536146995,0.0526595283169983,0.0895392979536871,0.060571885370006,0.0176513432251245,0.0198661952088003,0.0131053690915716,0.0348519141288624,0.0396627341786802,0.0563415383741196,0.0641210319706858,0.0397543108110701,0.0834858540811919,0.0932152789666333,0.043988381014097,0.0495330426662223,0.03350192754747,0.108611174628209,0.13060888390216,0.100798403146076,0.0808371649273259,0.0706065248472259,0.0334735607023706,0.0381308639270561,0.0833578031635988,0.0642585931677307,0.0439424429921028,0.0869667637648818,0.0640562229645886,0.0415139210593025,0.0313356705344928,0.0572278192707307,0.0628059055451348,0.0379463150780048,0.0376191469151423,0.0449550598628002,0.0841615733789328,0.117637682779394,0.135637502414022,0.0392706691568913,0.0301791993886598,0.0313900505017529,0.0379686684572242,0.151207298605847,0.0912316915362054,0.053960446781245,0.0614081397826804,0.0422283391755564,0.0830068221609111,0.0659018924478304,0.0625933095083558,0.0387549683008809,0.0441965137883626,0.0305982511721646,0.0889059515002094,0.105831157100779,0.0744644684284087,0.0197336817371044,0.0224546229613485,0.0153589180106669,0.0416211485578732,0.0259383326779085,0.0201193830545641,0.0224259355080891,0.0148285629771976,0.0710629956054671,0.0809569011527293,0.153544838263241,0.114217670122386,0.0779003294258267,0.0881752757257687,0.0585224932869634,0.053979129283717,0.0598399088978484,0.0420327804194913,0.0513827371799764,0.0592083175303697,0.0271610768567251,0.030879656096925],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[2.67135962890714,3.30013392230896,6.70530774197066,4.49263187289404,3.20744104878074,-3.00241247613022,8.80557426970619,4.09149370497874,5.65781860641453,2.67227079922533,3.02428506916939,2.94498185811314,2.81606084878426,3.59566069315687,3.34946692639603,2.70204192215381,6.8826298569843,4.06885426690476,3.02111012506308,5.99067976718417,4.26068273600736,3.69608679169395,4.87888110156552,3.85584459868992,6.83649720687489,4.67388851021491,4.70747918333404,3.67089936123912,3.02260808282314,2.4338473256811,4.42980707321376,3.16489496827183,2.566134997368,-2.14049426387986,-4.19509604249912,3.71527476712316,-2.91258356907569,4.06201723316392,-3.16621792453047,3.80824219541075,2.82562843621566,3.88867368917609,5.00040762885599,3.60840307379194,2.8764916341344,-3.06811608621822,5.75407833129223,4.65946293109298,2.51393959139649,2.29822791005983,3.90466678048895,3.74855894811697,3.27506916012094,8.01887200489851,4.55924074890284,3.57107284074837,3.93277614990277,5.70809552465599,-3.4170276635536,15.776913745137,12.4880681802687,2.01327542182708,-3.19051958430907,5.82614565770719,4.31079115544767,-3.53124491406835,11.1893464987799,3.20616987873748,2.52908005858233,2.51553666168356,3.22922003529235,3.22046372636548,3.20459127158485,-2.4928962764871,-3.74443350023166,-4.137703793678,3.6768746827248,7.48483131925827,5.21214370216975,4.79684159288429,5.14001269996103],[0.0151089323346628,0.00289916101766026,6.02947047143801e-11,1.40696658228357e-05,0.00401764514272865,0.00535697964230946,3.90552889288084e-18,4.28603582683453e-05,3.06618079684508e-08,0.0150679644848418,0.00747664452398131,0.0096892079954539,0.00972329155297812,0.00097070795832719,0.00242901664473198,0.0137830145172729,1.76272680430277e-11,9.44897694232885e-05,0.00251849743782203,6.26897244785433e-09,4.07606739312507e-05,0.000437896299756274,3.20068056469012e-06,0.000345992217869701,2.43458819527073e-11,5.91099626601065e-06,7.52396648402024e-06,0.000483397001606103,0.00751819715790952,0.0298785898472648,2.82952279880968e-05,0.00465416827041062,0.0205677590873336,0.0323148438746282,8.18267967141327e-05,0.000405966006248221,0.0107535681601442,0.00014595145399536,0.00463305140800414,0.000419874476324581,0.00943759322120502,0.000201587050825263,1.7162769557381e-06,0.000924262723332195,0.0120636856400102,0.00430825838900243,2.61347275467097e-08,9.5110644213564e-06,0.0238781764527106,0.0238781764527106,0.000283065909329318,0.00035570707627266,0.00316908326898512,3.20161918255882e-15,1.02677781149548e-05,0.000355521997136561,0.000167940854589125,3.4274189600004e-08,0.000633088462151448,1.34577727653856e-55,1.73468258370975e-35,0.0440856625418114,0.00284034430637589,1.70166342725799e-08,3.25342973473165e-05,0.000413608585711819,1.37942989535129e-28,0.0040354365209275,0.0228723875516198,0.0237702630983849,0.00372385051205522,0.00383950163821438,0.00405763198110529,0.0253411708003921,0.000361602509162227,0.000105239648978659,0.000708326874009864,2.14917262643784e-13,3.73341712292225e-07,3.22373938339391e-06,8.24159699594488e-07],[0.0226633985019942,0.00869748305298078,1.8088411414314e-10,2.11044987342535e-05,0.00803546946346419,0.00803546946346419,1.17165866786425e-17,4.28603582683453e-05,4.59927119526761e-08,0.0226019467272628,0.0224299335719439,0.0145849373294672,0.0145849373294672,0.00291212387498157,0.00728704993419595,0.0206745217759094,5.28818041290831e-11,0.000141734654134933,0.00251849743782203,1.8806917343563e-08,6.1141010896876e-05,0.000656844449634411,9.60204169407037e-06,0.0010379766536091,7.30376458581219e-11,8.86649439901598e-06,2.25718994520607e-05,0.000725095502409154,0.0225545914737286,0.0448178847708972,8.48856839642904e-05,0.0139625048112319,0.0308516386310004,0.0323148438746282,0.000245480390142398,0.000608949009372331,0.0322607044804326,0.000437854361986079,0.0138991542240124,0.00125962342897374,0.0141563898318075,0.000302380576237894,5.14883086721431e-06,0.00277278816999659,0.0361910569200307,0.00646238758350365,7.84041826401292e-08,2.85331932640692e-05,0.0238781764527106,0.0238781764527106,0.000533560614408991,0.000533560614408991,0.00950724980695536,9.60485754767646e-15,1.54016671724322e-05,0.000355521997136561,0.000251911281883687,1.02822568800012e-07,0.000633088462151448,4.03733182961568e-55,2.60202387556462e-35,0.0440856625418114,0.00426051645956383,5.10499028177396e-08,4.88014460209747e-05,0.000413608585711819,4.13828968605387e-28,0.0121063095627825,0.0343085813274297,0.0356553946475774,0.0111715515361657,0.0115185049146431,0.0121728959433159,0.0380117562005881,0.00054240376374334,0.000315718946935976,0.00212498062202959,6.44751787931351e-13,5.60012568438337e-07,4.83560907509086e-06,2.47247909878346e-06]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>GeneId<\/th>\n      <th>Level1<\/th>\n      <th>Level2<\/th>\n      <th>Difference<\/th>\n      <th>CI_low<\/th>\n      <th>CI_high<\/th>\n      <th>SE<\/th>\n      <th>df<\/th>\n      <th>z<\/th>\n      <th>p<\/th>\n      <th>padj<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[4,5,6,7,8,9,10,11]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-22_223e4674da1d55df9acd2ccef1d65398">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>test_heng <span class="ot">&lt;-</span> DNA_test <span class="sc">%&gt;%</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">res =</span> <span class="fu">list</span>(<span class="fu">estimate_contrasts</span>(test,<span class="at">contrast =</span> <span class="st">"heng"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(res) <span class="sc">%&gt;%</span> </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>test,<span class="sc">-</span>data) <span class="sc">%&gt;%</span> </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.adj =</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">"fdr"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p.adj <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(DNA_table <span class="sc">%&gt;%</span> </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>               <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>               <span class="fu">summarise</span>(<span class="at">Mutations =</span> <span class="fu">sum</span>(N), <span class="at">.by =</span> <span class="fu">c</span>(GeneId,sample)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>               <span class="fu">summarise</span>(<span class="at">y.position =</span> <span class="fu">max</span>(Mutations),<span class="at">.by =</span> GeneId)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Level1_n =</span> <span class="fu">case_when</span>( Level1 <span class="sc">==</span> <span class="st">"FAVORABLE"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>                               Level1 <span class="sc">==</span> <span class="st">"INTERMEDIO"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>                               Level1 <span class="sc">==</span> <span class="st">"MALO"</span> <span class="sc">~</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Level2_n =</span> <span class="fu">case_when</span>( Level2 <span class="sc">==</span> <span class="st">"FAVORABLE"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>                               Level2 <span class="sc">==</span> <span class="st">"INTERMEDIO"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>                               Level2 <span class="sc">==</span> <span class="st">"MALO"</span> <span class="sc">~</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">xmax =</span> <span class="fu">max</span>(Level1_n,Level2_n)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">xmin =</span> <span class="fu">min</span>(Level1_n,Level2_n)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_significance</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group1 =</span> Level1, <span class="at">group2 =</span> Level2) <span class="sc">%&gt;%</span> </span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GeneId) <span class="sc">%&gt;%</span> </span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">offset =</span> <span class="fu">row_number</span>() <span class="sc">*</span> y.position<span class="sc">/</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y.position =</span> y.position <span class="sc">+</span> offset)</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>DNA_table <span class="sc">%&gt;%</span> </span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(BED) <span class="sc">%&gt;%</span> </span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(test_heng <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(GeneId) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GeneId,sample,ID) <span class="sc">%&gt;%</span> </span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Mutations =</span> <span class="fu">sum</span>(N)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(metadata2) <span class="sc">%&gt;%</span> </span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(SLP_score<span class="sc">:</span>Sexo,estadio),as_factor) <span class="sc">%&gt;%</span> </span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(heng) <span class="sc">%&gt;%</span> </span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> heng, <span class="at">y =</span> Mutations, <span class="at">fill =</span> heng)) <span class="sc">+</span> </span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="at">data =</span> test_heng, <span class="fu">aes</span>(<span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax, <span class="at">y =</span> y.position, <span class="at">height =</span> y.position<span class="sc">/</span><span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> GeneId, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x=</span><span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="AnalisisIntergrado_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
</section>
<section id="sg-1" class="level3">
<h3 class="anchored" data-anchor-id="sg-1">SG</h3>
<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-23_5bf6577f57f03894f123a20a6cf2be83">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>DNA_test <span class="sc">%&gt;%</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">res =</span> <span class="fu">list</span>(<span class="fu">estimate_contrasts</span>(test,<span class="at">contrast =</span> <span class="st">"SG_score"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(res) <span class="sc">%&gt;%</span> </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>test,<span class="sc">-</span>data) <span class="sc">%&gt;%</span> </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">padj =</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">"fdr"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(padj <span class="sc">&lt;</span> <span class="fl">0.05</span>)<span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-3d2737a7de6600a20c0e" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3d2737a7de6600a20c0e">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58"],["ABL2","ABL2","ARID1B","ARID1B","BAP1","BLM","BLM","BLM","BRAF","BRAF","BRAF","BRCA1","BRCA1","CDH1","CDH1","CHEK2","CHEK2","CHEK2","CTNNB1","EGFR","FANCA","FGFR1","FGFR3","FGFR3","GNAS","GNAS","IDH1","IDH1","JAK1","JAK1","KDM5C","KDM5C","KRAS","MDM2","MDM2","MET","MET","MET","MSH6","NPM1","NPM1","NPM1","PBRM1","PBRM1","PRKDC","PRKDC","PTK2","PTK2","RB1","RB1","SLX4","SLX4","TP53","TP53BP1","TP53BP1","TSC2","VHL","VHL"],["Alto","Medio","Alto","Medio","Medio","Alto","Alto","Medio","Alto","Alto","Medio","Alto","Alto","Alto","Alto","Alto","Alto","Medio","Medio","Alto","Alto","Alto","Alto","Medio","Alto","Alto","Alto","Alto","Alto","Medio","Alto","Medio","Alto","Alto","Medio","Alto","Alto","Medio","Medio","Alto","Alto","Medio","Alto","Alto","Alto","Medio","Alto","Medio","Alto","Medio","Alto","Alto","Medio","Alto","Medio","Medio","Alto","Medio"],["Bajo","Bajo","Medio","Bajo","Bajo","Bajo","Medio","Bajo","Bajo","Medio","Bajo","Bajo","Medio","Bajo","Medio","Bajo","Medio","Bajo","Bajo","Medio","Bajo","Medio","Medio","Bajo","Bajo","Medio","Bajo","Medio","Medio","Bajo","Medio","Bajo","Medio","Medio","Bajo","Bajo","Medio","Bajo","Bajo","Bajo","Medio","Bajo","Bajo","Medio","Bajo","Bajo","Medio","Bajo","Medio","Bajo","Bajo","Medio","Bajo","Bajo","Bajo","Bajo","Bajo","Bajo"],[0.244944075978783,0.264193651654056,-0.178798041109531,0.116714843678623,0.387997056401688,-0.171639735530442,-0.334791568259801,0.163151832729359,-0.454426023951536,-0.286796443240856,-0.16762958071068,-0.328147627383318,-0.320162272497528,-0.265790277596214,-0.160784494610316,-0.350297347976181,-0.597943633456085,0.247646285479904,0.302184304632218,-0.108207706438788,0.228180861567027,-0.177309073306961,-0.178443162286811,0.273063985993762,-0.186676221969209,-0.138538850221957,0.503586191633261,0.397269356470492,-0.226460168903656,0.170199767712625,-0.295231999428688,0.229406943395388,-0.402201082193385,-0.435201574205034,0.300650083565923,0.489202847842652,0.208413128744775,0.280789719097876,0.234023644807268,-0.58573506324587,-0.24727098407033,-0.33846407917554,-0.0933152913568284,-0.0765108343518808,0.181913782627555,0.245418237183554,-0.298301528399243,0.310832504752285,-0.401915711729551,0.40523883435528,-0.29063156575315,-0.247928035562649,0.177769532140424,0.249898872972795,0.260062399423701,0.0753814774356357,0.8627832028516,0.626080894803954],[0.100842795787275,0.154925830317996,-0.261813883402435,0.0403136231036381,0.0670015667614405,-0.335297706965796,-0.472217462584687,0.0464053181692135,-0.702857940886189,-0.492531920926663,-0.340628118125994,-0.46323885409868,-0.430747020614809,-0.447038507843087,-0.308608883527259,-0.70180711462576,-0.882862438862703,0.0102144485723249,0.1267187862599,-0.189299373792674,0.0625781168916776,-0.277866052806986,-0.301251499674451,0.159420474947825,-0.331987691394892,-0.257607393924734,0.155706512829714,0.12590097828035,-0.322891618445525,0.0813926627979331,-0.371021768078707,0.157650167063752,-0.741779675141333,-0.66771539374831,0.110038707075884,0.33290844983481,0.0853053038768499,0.153685078149392,0.0909651451271175,-0.875237826373281,-0.483969813707632,-0.547917851991651,-0.152378818846603,-0.124998936604307,0.0369278384478683,0.135529478613964,-0.347615607901571,0.267748444443072,-0.801344727993337,0.0720192565170352,-0.548923753967258,-0.454673829952273,0.0697125381487592,0.127974853911103,0.16588986398975,0.0154491391976941,0.429633254776525,0.287314209339061],[0.389045356170291,0.373461472990116,-0.0957821988166269,0.193116064253608,0.708992546041936,-0.00798176409508924,-0.197365673934916,0.279898347289504,-0.205994107016882,-0.081060965555048,0.00536895670463378,-0.193056400667956,-0.209577524380247,-0.0845420473493418,-0.012960105693372,0.00121241867339772,-0.313024828049468,0.485078122387483,0.477649823004535,-0.0271160390849024,0.393783606242377,-0.0767520938069363,-0.0556348248991713,0.386707497039699,-0.0413647525435266,-0.0194703065191793,0.851465870436808,0.668637734660634,-0.130028719361787,0.259006872627318,-0.219442230778668,0.301163719727024,-0.062622489245437,-0.202687754661758,0.491261460055962,0.645497245850494,0.331520953612701,0.407894360046361,0.377082144487418,-0.29623230011846,-0.0105721544330286,-0.129010306359429,-0.0342517638670535,-0.0280227320994541,0.326899726807242,0.355306995753144,-0.248987448896915,0.353916565061497,-0.00248669546576558,0.738458412193524,-0.0323393775390419,-0.0411822411730247,0.285826526132089,0.371822892034487,0.354234934857653,0.135313815673577,1.29593315092668,0.964847580268846],[0.0601931896845715,0.0456427499281087,0.0346769184515247,0.031913895255414,0.134084460388756,0.0683623025757194,0.0574047844243731,0.0487667082942788,0.103773606173907,0.0859386857405416,0.0722639921307728,0.0564295599844257,0.0461928492987554,0.0757100081882952,0.0617483860674808,0.146830715395438,0.119014707404055,0.0991787135904736,0.073294485770356,0.0338731627393152,0.0691746624962768,0.0420041052592206,0.0512988193956148,0.0474705388301742,0.0606987032374704,0.0497366534637444,0.145314375179741,0.113354497899571,0.040280811704919,0.0370960126403009,0.0316584829394821,0.0299738436962067,0.14184689151249,0.0971243865804145,0.0796211298459952,0.0652864314142044,0.0514239196493047,0.0530934475546203,0.0597576051773686,0.120929492867633,0.0988725258480652,0.087491871415118,0.0246716900009986,0.0202541818674087,0.0605627266323125,0.0459021243946675,0.0205992045154544,0.017996835358627,0.166847279285342,0.139190638894909,0.107892384151984,0.0863607096456276,0.0451369698273381,0.0509294268359888,0.039337230598642,0.0250346048210119,0.180933000398714,0.141507746009626],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[4.06929882371006,5.78829391459069,-5.1561110125594,3.65717950580862,2.89367653251356,-2.51073660575331,-5.83211959799041,3.34555762396002,-4.3790135151514,-3.33722165715596,-2.31968336882536,-5.81517253499558,-6.93099207686576,-3.51063596420672,-2.60386553965321,-2.38572254471945,-5.02411547697267,2.49697013113599,4.12287911506757,-3.19449669555644,3.29861908006141,-4.22123200131822,-3.47850426947769,5.75228326290224,-3.07545650915933,-2.78544776485504,3.46549466293593,3.50466336873957,-5.62203588553804,4.58808792640214,-9.32552579961107,7.65357108419233,-2.83545926107215,-4.48086818900737,3.77600875731663,7.49317794288594,4.05284408823926,5.28859458239195,3.91621525181028,-4.84360803436927,-2.50090691978786,-3.86852028309747,-3.78228209551317,-3.77753270177728,3.00372510854716,5.34655509783039,-14.4812159214908,17.2715090491331,-2.40888382148681,2.91139431194968,-2.69371715193306,-2.87084296296309,3.93844630732732,4.90676782555515,6.61110086973634,3.01109116659061,4.76852316023237,4.42435776456622],[9.43096721500223e-05,2.13314747217969e-08,7.56394358122164e-07,0.000510011607422309,0.0114228056326115,0.0120479553647012,1.64183003847971e-08,0.00164234588177739,3.57653217554557e-05,0.00169240865463944,0.0203580121729363,1.21142756691482e-08,1.2536983795296e-11,0.00134110839206297,0.0184357824653894,0.0250519013773415,1.51727402514886e-06,0.0250519013773415,0.000112249824804582,0.00420224666241706,0.00291484979783709,7.28912119248089e-05,0.00100844081113842,2.64138329673121e-08,0.00630541736644595,0.0106907703296221,0.00137155490618905,0.00137155490618905,5.66160145808706e-08,8.94648480516876e-06,3.31303970342267e-20,3.90947008558793e-14,0.0137279552517773,2.23020043620107e-05,0.000318722780630574,2.01676980448646e-13,5.05987249396114e-05,2.46519497068232e-07,0.00026984982978519,3.82507028682004e-06,0.0123875731462699,0.000218995658422255,0.000466191330949387,0.000466191330949387,0.005333923431184,2.68932003439765e-07,3.18509630538646e-47,2.31299160898429e-66,0.0320027816404319,0.0107945884044865,0.014132020014252,0.0122813652536298,0.00024603282298789,1.85179053825316e-06,1.14441729588056e-10,0.00780932051647642,5.56744022669201e-06,1.93459215684593e-05],[0.000141464508225033,6.39944241653907e-08,2.26918307436649e-06,0.000765017411133464,0.0342684168978345,0.0120479553647012,4.92549011543912e-08,0.00246351882266609,0.000107295965266367,0.00253861298195917,0.0203580121729363,1.81714135037223e-08,3.76109513858881e-11,0.0040233251761889,0.0276536736980842,0.0250519013773415,4.55182207544659e-06,0.0250519013773415,0.000336749474413747,0.0126067399872512,0.00874454939351127,0.000218673635774427,0.00151266121670763,7.92414989019362e-08,0.0160361554944332,0.0160361554944332,0.00205733235928357,0.00205733235928357,1.69848043742612e-07,1.34197272077531e-05,9.93911911026801e-20,5.86420512838189e-14,0.0411838657553319,6.69060130860321e-05,0.000478084170945862,6.05030941345937e-13,5.05987249396114e-05,3.69779245602348e-07,0.00080954948935557,1.14752108604601e-05,0.0123875731462699,0.000328493487633382,0.000699286996424081,0.000699286996424081,0.008000885146776,8.06796010319295e-07,4.77764445807969e-47,6.93897482695287e-66,0.0480041724606478,0.0323837652134595,0.0211980300213779,0.0211980300213779,0.000738098468963671,2.77768580737974e-06,3.43325188764167e-10,0.0234279615494292,1.6702320680076e-05,2.90188823526889e-05]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>GeneId<\/th>\n      <th>Level1<\/th>\n      <th>Level2<\/th>\n      <th>Difference<\/th>\n      <th>CI_low<\/th>\n      <th>CI_high<\/th>\n      <th>SE<\/th>\n      <th>df<\/th>\n      <th>z<\/th>\n      <th>p<\/th>\n      <th>padj<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[4,5,6,7,8,9,10,11]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-24_93bb2df32a7453a07881cfeeedad1629">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>test_SG <span class="ot">&lt;-</span> DNA_test <span class="sc">%&gt;%</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">res =</span> <span class="fu">list</span>(<span class="fu">estimate_contrasts</span>(test,<span class="at">contrast =</span> <span class="st">"SG_score"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(res) <span class="sc">%&gt;%</span> </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>test,<span class="sc">-</span>data) <span class="sc">%&gt;%</span> </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.adj =</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">"fdr"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p.adj <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(DNA_table <span class="sc">%&gt;%</span> </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>               <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>               <span class="fu">summarise</span>(<span class="at">Mutations =</span> <span class="fu">sum</span>(N), <span class="at">.by =</span> <span class="fu">c</span>(GeneId,sample)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>               <span class="fu">summarise</span>(<span class="at">y.position =</span> <span class="fu">max</span>(Mutations),<span class="at">.by =</span> GeneId)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Level1_n =</span> <span class="fu">case_when</span>( Level1 <span class="sc">==</span> <span class="st">"Bajo"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>                               Level1 <span class="sc">==</span> <span class="st">"Medio"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>                               Level1 <span class="sc">==</span> <span class="st">"Alto"</span> <span class="sc">~</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Level2_n =</span> <span class="fu">case_when</span>( Level2 <span class="sc">==</span> <span class="st">"Bajo"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>                               Level2 <span class="sc">==</span> <span class="st">"Medio"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>                               Level2 <span class="sc">==</span> <span class="st">"Alto"</span> <span class="sc">~</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">xmax =</span> <span class="fu">max</span>(Level1_n,Level2_n)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">xmin =</span> <span class="fu">min</span>(Level1_n,Level2_n)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_significance</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group1 =</span> Level1, <span class="at">group2 =</span> Level2) <span class="sc">%&gt;%</span> </span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GeneId) <span class="sc">%&gt;%</span> </span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">offset =</span> <span class="fu">row_number</span>() <span class="sc">*</span> y.position<span class="sc">/</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y.position =</span> y.position <span class="sc">+</span> offset)</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>DNA_table <span class="sc">%&gt;%</span> </span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(BED) <span class="sc">%&gt;%</span> </span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(test_SG <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(GeneId) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GeneId,sample,ID) <span class="sc">%&gt;%</span> </span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Mutations =</span> <span class="fu">sum</span>(N)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(metadata2) <span class="sc">%&gt;%</span> </span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(SLP_score<span class="sc">:</span>Sexo,estadio),as_factor) <span class="sc">%&gt;%</span> </span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(SLP_score) <span class="sc">%&gt;%</span> </span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SG_score, <span class="at">y =</span> Mutations, <span class="at">fill =</span> SG_score)) <span class="sc">+</span> </span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="at">data =</span> test_SG, <span class="fu">aes</span>(<span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax, <span class="at">y =</span> y.position, <span class="at">height =</span> y.position<span class="sc">/</span><span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> GeneId, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x=</span><span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="AnalisisIntergrado_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
</section>
<section id="slp-1" class="level3">
<h3 class="anchored" data-anchor-id="slp-1">SLP</h3>
<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-25_22b3fa787679cde8f060fa82f201dae0">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>DNA_test <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">res =</span> <span class="fu">list</span>(<span class="fu">estimate_contrasts</span>(test,<span class="at">contrast =</span> <span class="st">"SLP_score"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(res) <span class="sc">%&gt;%</span> </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>test,<span class="sc">-</span>data) <span class="sc">%&gt;%</span> </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">padj =</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">"fdr"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(padj <span class="sc">&lt;</span> <span class="fl">0.05</span>)<span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-e80f5d469413d4e01d8c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e80f5d469413d4e01d8c">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63"],["APC","ARID1B","ARID1B","ARID1B","BCOR","BCOR","BLM","BLM","BLM","BRCA1","BRCA1","CDH1","CDH1","CDKN1A","CDKN1A","CHEK2","CHEK2","CHEK2","CTNNB1","CTNNB1","CTNNB1","EGFR","EGFR","FANCA","FANCA","FANCB","FBXW7","FBXW7","FGFR1","FGFR1","HNF1A","IDH1","IDH1","JAK1","JAK1","JAK1","KDM5C","KDM5C","KDM5C","KRAS","KRAS","MDM2","MDM2","NEDD4","NEDD4","NEDD4","PBRM1","PBRM1","PTK2","PTK2","PTK2","TERT","TET2","TET2","TP53","TP53","TSC1","TSC1","TSC2","TSC2","VHL","VHL","VHL"],["Largo","Largo","MuyLargo","MuyLargo","Largo","MuyLargo","Largo","MuyLargo","MuyLargo","Largo","MuyLargo","Largo","MuyLargo","MuyLargo","MuyLargo","Largo","MuyLargo","MuyLargo","Largo","MuyLargo","MuyLargo","Largo","MuyLargo","Largo","MuyLargo","MuyLargo","Largo","MuyLargo","MuyLargo","MuyLargo","Largo","MuyLargo","MuyLargo","Largo","MuyLargo","MuyLargo","Largo","MuyLargo","MuyLargo","MuyLargo","MuyLargo","MuyLargo","MuyLargo","Largo","MuyLargo","MuyLargo","Largo","MuyLargo","Largo","MuyLargo","MuyLargo","Largo","MuyLargo","MuyLargo","Largo","MuyLargo","Largo","MuyLargo","Largo","MuyLargo","Largo","MuyLargo","MuyLargo"],["Refractario","Refractario","Largo","Refractario","Refractario","Refractario","Refractario","Largo","Refractario","Refractario","Refractario","Refractario","Refractario","Largo","Refractario","Refractario","Largo","Refractario","Refractario","Largo","Refractario","Refractario","Refractario","Refractario","Refractario","Largo","Refractario","Refractario","Largo","Refractario","Refractario","Largo","Refractario","Refractario","Largo","Refractario","Refractario","Largo","Refractario","Largo","Refractario","Largo","Refractario","Refractario","Largo","Refractario","Refractario","Refractario","Refractario","Largo","Refractario","Refractario","Largo","Refractario","Refractario","Refractario","Refractario","Refractario","Refractario","Refractario","Refractario","Largo","Refractario"],[0.0540433861883697,0.139818065581509,0.106838470484687,0.246656536066197,0.132809042034949,0.216321281472719,0.102225484180411,0.313071889726233,0.415297373906644,0.145394418684797,0.205337987066902,0.158337149021566,0.285535130310447,0.640755773817587,0.676854675418156,0.263279361826487,0.601311311381242,0.86459067320773,-0.135330910571946,0.550108597835723,0.414777687263777,0.0967341130783284,0.159453199549064,0.218757320211879,0.288400773214518,0.30505586514987,0.360733421138856,0.467151435676671,0.249384958396158,0.268888611821786,0.436823100388936,-0.442909964836043,-0.504682926230648,0.272906322722362,0.237573061391663,0.510479384114025,0.289171554218637,0.245227440336842,0.534398994555479,0.558002854031562,0.54925984608546,0.489052122367187,0.519959802127617,0.0914530009142626,0.0992029466395409,0.190655947553804,-0.0557612486657993,-0.0900269359743789,0.116774601720984,0.343024269113562,0.459798870834546,0.19626114069941,0.300032490467975,0.256579844853653,0.13388710731789,0.182868918263469,0.139993823955087,0.194498790948327,-0.0760433407156368,-0.136832411464389,-0.29545273699312,-0.456724271820338,-0.752177008813458],[0.0195999150992507,0.0714302273623857,0.00627981760563016,0.126013625718048,0.0433784917667578,0.0665509792222667,-0.0028318042362237,0.152690485404789,0.226129025025426,0.058596466665342,0.0474027473416374,0.0370880869866859,0.0751869987672927,0.266934886370892,0.220367178457008,0.0498796711962484,0.284059139353497,0.482765488486709,-0.293802618945371,0.322522746698474,0.141196718328109,0.0288757693116006,0.0415950072126747,0.0995097388704839,0.0930300552009999,0.076277524951639,0.156836734224811,0.125247490989511,0.1327024224838,0.126545203849831,0.211564439759927,-0.792041193080104,-0.937125293676176,0.192499040330435,0.125998782270584,0.373755089998636,0.224688014613766,0.156412102419189,0.424965734130485,0.167623294956095,0.0949677282094971,0.230118414733001,0.213082596150323,0.0111318098578095,-0.014834385703611,0.0522100948584448,-0.0956511806874387,-0.160207272863861,0.0781380588713805,0.283980097685837,0.389769425002043,0.0458085700160786,0.0985410276256317,0.0135888959239321,0.0364980401117123,0.0184445486773951,0.0294311449217931,0.00644775068933345,-0.129802999095796,-0.228369418105879,-0.600488945607045,-0.894209476573017,-1.2789622925533],[0.0884868572774888,0.208205903800633,0.207397123363745,0.367299446414345,0.22223959230314,0.366091583723171,0.207282772597045,0.473453294047678,0.604465722787862,0.232192370704252,0.363273226792166,0.279586211056445,0.495883261853601,1.01457666126428,1.1333421723793,0.476679052456726,0.918563483408988,1.24641585792875,0.0231407978014798,0.777694448972972,0.688358656199446,0.164592456845056,0.277311391885453,0.338004901553274,0.483771491228036,0.533834205348101,0.564630108052901,0.80905538036383,0.366067494308515,0.41123201979374,0.662081761017945,-0.0937787365919815,-0.0722405587851198,0.35331360511429,0.349147340512741,0.647203678229413,0.353655093823509,0.334042778254495,0.643832254980474,0.948382413107029,1.00355196396142,0.747985830001372,0.826837008104911,0.171774191970716,0.213240278982693,0.329101800249162,-0.0158713166441599,-0.0198465990848972,0.155411144570588,0.402068440541287,0.52982831666705,0.346713711382741,0.501523953310319,0.499570793783374,0.231276174524067,0.347293287849543,0.250556502988382,0.38254983120732,-0.0222836823354775,-0.0452954048228991,0.00958347162080442,-0.0192390670676592,-0.225391725073614],[0.0143875362238772,0.02856658950268,0.0420048042538541,0.0503942891904497,0.0373564347848595,0.0625612222215937,0.0438839494070079,0.0669936330847917,0.0790183563351532,0.0362567604062638,0.0659718347403088,0.0506474875201837,0.0878654579955523,0.156150393363818,0.190681432230863,0.0891401383781169,0.132520822461324,0.159493904146546,0.0661959254566139,0.0950659028762493,0.114278729067141,0.0283454120088533,0.049231072185874,0.049811440075825,0.0816091756615194,0.0955640228107083,0.0851705962303871,0.14281822457862,0.0487399834874144,0.0594589010244554,0.0940938017296914,0.145837165489253,0.180637433732027,0.0335872852385902,0.0466061907162027,0.0571117158656701,0.026935707481642,0.0370994516847578,0.0457118562292341,0.163067190084504,0.189764390622846,0.10816035609566,0.128187049030472,0.0335513236421387,0.0476350436840767,0.0578308357931235,0.0166626017582369,0.0293153421322946,0.0161390429662493,0.0246636046938247,0.0292523127546075,0.0628462156174991,0.0841658993353323,0.101500835114875,0.0406808224587195,0.0686824381720093,0.0461836307230646,0.0785516403577214,0.022456187134175,0.0382363320895312,0.127418037795077,0.182743899838188,0.220045834881222],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[3.7562641266321,4.89446125756075,2.54348216549264,4.89453348838862,3.55518514547261,3.45775344200442,2.32945041551083,4.6731588557078,5.25570757439166,4.01013264990102,3.11250987448194,3.12625871043388,3.24968579034665,4.10345283168565,3.5496622167106,2.95354445950826,4.53748550765849,5.42083835638839,-2.0443994043205,5.78660256929153,3.62952660262861,3.4126903164475,3.2388731845417,4.39170840832704,3.53392582239383,3.19216224032468,4.23542204827437,3.27095114825145,5.11664019050301,4.52226003489691,4.64242162989463,-3.03701709608914,-2.79390000070161,8.12528672036899,5.09745717770214,8.93826032673751,10.7356212720873,6.61000174397707,11.6905993026316,3.42191984630628,2.89443053189629,4.52154689593161,4.05625846027562,2.72576432124432,2.08256231058527,3.29678699847658,-3.34649111074354,-3.07098363608053,7.23553447160334,13.908115758904,15.718376686716,3.12287921827965,3.56477496037428,2.52785944631159,3.29116028698168,2.66252805128277,3.0312433596775,2.4760627539105,-3.38629796150523,-3.57859669028904,-2.31876696663851,-2.49925864679887,-3.41827423918055],[0.000517406011207347,2.95617590473556e-06,0.01097536597127,2.95617590473556e-06,0.00113313905453375,0.00113313905453375,0.0198352168957864,5.93204353696409e-06,4.42369295807591e-07,0.000182053937020253,0.00371007616144889,0.00354091449735104,0.00346597748701872,0.000122108840126465,0.000771451471592651,0.00314147353644814,1.13857882583367e-05,1.7796054179538e-07,0.0409141061167547,2.1547271325993e-08,0.000567882938366435,0.00192974983001906,0.00240005834418845,3.37390388103457e-05,0.000818871938093875,0.00423635972290529,6.84368496326219e-05,0.00214372848912907,9.33078399054812e-07,1.22365661688288e-05,1.03304780134763e-05,0.00716795711954974,0.0104153159254284,8.92612251434843e-16,3.4424625421116e-07,1.18603453228582e-18,1.38503164134324e-26,3.84315496506088e-11,4.27135074251451e-31,0.00186541924266296,0.00759693897483582,1.84168066782367e-05,9.97301569168497e-05,0.0128305574950544,0.0372911376562369,0.00293392916936932,0.00245523910741652,0.00426709687160642,4.63699336417802e-13,1.13099276592257e-43,3.3955996800461e-55,0.0053727367820151,0.00109250552630193,0.0229520568575302,0.00299325134525761,0.0155112210039719,0.00730646592798833,0.0265680453984746,0.00141684838815656,0.00103633220324703,0.0248906881430037,0.0248906881430037,0.00189058723805881],[0.00155221803362204,4.43426385710334e-06,0.01097536597127,4.43426385710334e-06,0.00169970858180063,0.00169970858180063,0.0198352168957864,8.89806530544613e-06,1.32710788742277e-06,0.000546161811060759,0.00556511424217333,0.00531137174602656,0.00531137174602656,0.000366326520379394,0.00115717720738898,0.00314147353644814,1.70786823875051e-05,5.3388162538614e-07,0.0409141061167547,6.46418139779789e-08,0.000851824407549653,0.00360008751628267,0.00360008751628267,0.000101217116431037,0.00122830790714081,0.0127090791687159,0.000205310548897866,0.00321559273369361,2.79923519716443e-06,1.83548492532432e-05,3.09914340404288e-05,0.0156229738881427,0.0156229738881427,1.33891837715226e-15,3.4424625421116e-07,3.55810359685745e-18,2.07754746201486e-26,3.84315496506088e-11,1.28140522275435e-30,0.00559625772798888,0.0113954084622537,5.52504200347101e-05,0.000149595235375275,0.0192458362425816,0.0372911376562369,0.00880178750810796,0.00640064530740964,0.00640064530740964,4.63699336417802e-13,1.69648914888385e-43,1.01867990401383e-54,0.0161182103460453,0.00327751657890579,0.0344280852862952,0.00897975403577283,0.0232668315059579,0.021919397783965,0.0398520680977118,0.00212527258223484,0.00212527258223484,0.0248906881430037,0.0248906881430037,0.00567176171417644]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>GeneId<\/th>\n      <th>Level1<\/th>\n      <th>Level2<\/th>\n      <th>Difference<\/th>\n      <th>CI_low<\/th>\n      <th>CI_high<\/th>\n      <th>SE<\/th>\n      <th>df<\/th>\n      <th>z<\/th>\n      <th>p<\/th>\n      <th>padj<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[4,5,6,7,8,9,10,11]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-26_ca68d4fccc94cf5fe714f8252aac029a">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>test_SLP <span class="ot">&lt;-</span> DNA_test <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">res =</span> <span class="fu">list</span>(<span class="fu">estimate_contrasts</span>(test,<span class="at">contrast =</span> <span class="st">"SLP_score"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(res) <span class="sc">%&gt;%</span> </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>test,<span class="sc">-</span>data) <span class="sc">%&gt;%</span> </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.adj =</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">"fdr"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p.adj <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(DNA_table <span class="sc">%&gt;%</span> </span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>               <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>               <span class="fu">summarise</span>(<span class="at">Mutations =</span> <span class="fu">sum</span>(N), <span class="at">.by =</span> <span class="fu">c</span>(GeneId,sample)) <span class="sc">%&gt;%</span> </span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>               <span class="fu">summarise</span>(<span class="at">y.position =</span> <span class="fu">max</span>(Mutations),<span class="at">.by =</span> GeneId)) <span class="sc">%&gt;%</span> </span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Level1_n =</span> <span class="fu">case_when</span>( Level1 <span class="sc">==</span> <span class="st">"Refractario"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>                               Level1 <span class="sc">==</span> <span class="st">"Largo"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>                               Level1 <span class="sc">==</span> <span class="st">"Muy Largo"</span> <span class="sc">~</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Level2_n =</span> <span class="fu">case_when</span>( Level2 <span class="sc">==</span> <span class="st">"Refractario"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>                               Level2 <span class="sc">==</span> <span class="st">"Largo"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>                               Level2 <span class="sc">==</span> <span class="st">"Muy Largo"</span> <span class="sc">~</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">xmax =</span> <span class="fu">max</span>(Level1_n,Level2_n)) <span class="sc">%&gt;%</span> </span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">xmin =</span> <span class="fu">min</span>(Level1_n,Level2_n)) <span class="sc">%&gt;%</span> </span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_significance</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group1 =</span> Level1, <span class="at">group2 =</span> Level2) <span class="sc">%&gt;%</span> </span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GeneId) <span class="sc">%&gt;%</span> </span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">offset =</span> <span class="fu">row_number</span>() <span class="sc">*</span> y.position<span class="sc">/</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y.position =</span> y.position <span class="sc">+</span> offset)</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>DNA_table <span class="sc">%&gt;%</span> </span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(BED) <span class="sc">%&gt;%</span> </span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(test_SLP <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(GeneId) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GeneId,sample,ID) <span class="sc">%&gt;%</span> </span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Mutations =</span> <span class="fu">sum</span>(N)) <span class="sc">%&gt;%</span> </span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(metadata2) <span class="sc">%&gt;%</span> </span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(SLP_score<span class="sc">:</span>Sexo,estadio),as_factor) <span class="sc">%&gt;%</span> </span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(SLP_score) <span class="sc">%&gt;%</span> </span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SLP_score, <span class="at">y =</span> Mutations, <span class="at">fill =</span> SLP_score)) <span class="sc">+</span> </span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="at">data =</span> test_SLP, <span class="fu">aes</span>(<span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax, <span class="at">y =</span> y.position, <span class="at">height =</span> y.position<span class="sc">/</span><span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> GeneId, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x=</span><span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="AnalisisIntergrado_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
</section>
<section id="respuesta" class="level3">
<h3 class="anchored" data-anchor-id="respuesta">Respuesta</h3>
<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-27_fb8f849ee24c855eaff717b442dfc46f">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>DNA_test <span class="sc">%&gt;%</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">res =</span> <span class="fu">list</span>(<span class="fu">estimate_contrasts</span>(test,<span class="at">contrast =</span> <span class="st">"Resp"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(res) <span class="sc">%&gt;%</span> </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>test,<span class="sc">-</span>data) <span class="sc">%&gt;%</span> </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">padj =</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">"fdr"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(padj <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 46 × 11
# Groups:   GeneId [24]
   GeneId Level1 Level2 Difference  CI_low  CI_high     SE    df     z         p
   &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
 1 ABL2   NE     PE         -0.398 -0.572  -0.225   0.0724   Inf -5.50   1.15e-7
 2 ABL2   NE     RP         -0.404 -0.588  -0.220   0.0767   Inf -5.26   2.82e-7
 3 AKT1   NE     PE         -0.329 -0.582  -0.0760  0.106    Inf -3.11   5.54e-3
 4 ARID1B PE     RP          0.132  0.0707  0.193   0.0255   Inf  5.17   7.01e-7
 5 ATM    NE     PE         -0.205 -0.381  -0.0290  0.0736   Inf -2.79   1.59e-2
 6 BCOR   NE     PE         -0.334 -0.486  -0.181   0.0636   Inf -5.25   4.67e-7
 7 BCOR   NE     RP         -0.316 -0.478  -0.155   0.0675   Inf -4.68   5.63e-6
 8 BCR    NE     PE         -0.199 -0.393  -0.00573 0.0808   Inf -2.46   2.74e-2
 9 BCR    NE     RP         -0.259 -0.466  -0.0515  0.0866   Inf -2.99   8.39e-3
10 BRAF   NE     PE         -0.374 -0.637  -0.111   0.110    Inf -3.41   1.31e-3
# … with 36 more rows, and 1 more variable: padj &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-28_d5771081e2d1397332611e8605fb1127">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>test_Resp <span class="ot">&lt;-</span> DNA_test <span class="sc">%&gt;%</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">res =</span> <span class="fu">list</span>(<span class="fu">estimate_contrasts</span>(test,<span class="at">contrast =</span> <span class="st">"Resp"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(res) <span class="sc">%&gt;%</span> </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>test,<span class="sc">-</span>data) <span class="sc">%&gt;%</span> </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.adj =</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">"fdr"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p.adj <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(DNA_table <span class="sc">%&gt;%</span> </span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>               <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>               <span class="fu">summarise</span>(<span class="at">Mutations =</span> <span class="fu">sum</span>(N), <span class="at">.by =</span> <span class="fu">c</span>(GeneId,sample)) <span class="sc">%&gt;%</span> </span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>               <span class="fu">summarise</span>(<span class="at">y.position =</span> <span class="fu">max</span>(Mutations),<span class="at">.by =</span> GeneId)) <span class="sc">%&gt;%</span> </span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Level1_n =</span> <span class="fu">case_when</span>( Level1 <span class="sc">==</span> <span class="st">"NE"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>                               Level1 <span class="sc">==</span> <span class="st">"PE"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>                               Level1 <span class="sc">==</span> <span class="st">"RP"</span> <span class="sc">~</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Level2_n =</span> <span class="fu">case_when</span>( Level2 <span class="sc">==</span> <span class="st">"NE"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>                               Level2 <span class="sc">==</span> <span class="st">"PE"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>                               Level2 <span class="sc">==</span> <span class="st">"RP"</span> <span class="sc">~</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">xmax =</span> <span class="fu">max</span>(Level1_n,Level2_n)) <span class="sc">%&gt;%</span> </span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">xmin =</span> <span class="fu">min</span>(Level1_n,Level2_n)) <span class="sc">%&gt;%</span> </span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_significance</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group1 =</span> Level1, <span class="at">group2 =</span> Level2) <span class="sc">%&gt;%</span> </span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GeneId) <span class="sc">%&gt;%</span> </span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">offset =</span> <span class="fu">row_number</span>() <span class="sc">*</span> y.position<span class="sc">/</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y.position =</span> y.position <span class="sc">+</span> offset)</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>DNA_table <span class="sc">%&gt;%</span> </span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(BED) <span class="sc">%&gt;%</span> </span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(test_Resp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(GeneId) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GeneId,sample,ID) <span class="sc">%&gt;%</span> </span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Mutations =</span> <span class="fu">sum</span>(N)) <span class="sc">%&gt;%</span> </span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(metadata2) <span class="sc">%&gt;%</span> </span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(SLP_score<span class="sc">:</span>Sexo,estadio),as_factor) <span class="sc">%&gt;%</span> </span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(Resp) <span class="sc">%&gt;%</span> </span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Resp, <span class="at">y =</span> Mutations, <span class="at">fill =</span> Resp)) <span class="sc">+</span> </span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="at">data =</span> test_Resp, <span class="fu">aes</span>(<span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax, <span class="at">y =</span> y.position, <span class="at">height =</span> y.position<span class="sc">/</span><span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> GeneId, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x=</span><span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="AnalisisIntergrado_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
</section>
</section>
<section id="integrado" class="level2">
<h2 class="anchored" data-anchor-id="integrado">Integrado</h2>
<div class="cell" data-hash="AnalisisIntergrado_cache/html/unnamed-chunk-29_b0fce49fa43e8c87ea37d4c4f6d7949b">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>RNA <span class="ot">&lt;-</span> count_trim <span class="sc">%&gt;%</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(ttg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"gene_id"</span> <span class="ot">=</span> <span class="st">"ensembl_gene_id"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gene_id,Sample) <span class="sc">%&gt;%</span> </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Expresion =</span> <span class="fu">sum</span>(counts)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sample =</span> <span class="fu">if_else</span>(Sample <span class="sc">==</span> <span class="st">"22-012-A-01"</span>,<span class="st">"22-012-A"</span>,Sample)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sample =</span> <span class="fu">if_else</span>(Sample <span class="sc">==</span> <span class="st">"24-017-A"</span>,<span class="st">"24-017-A1"</span>,Sample)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sample =</span> <span class="fu">if_else</span>(Sample <span class="sc">==</span> <span class="st">"8-019-A"</span>,<span class="st">"08-019-A"</span>,Sample)) <span class="sc">%&gt;%</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sample =</span> <span class="fu">if_else</span>(Sample <span class="sc">==</span> <span class="st">"8-021-A"</span>,<span class="st">"08-021-A"</span>,Sample)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">GeneId =</span> gene_id)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>DNA <span class="ot">&lt;-</span> DNA_table <span class="sc">%&gt;%</span> <span class="fu">semi_join</span>(BED) <span class="sc">%&gt;%</span> </span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sample <span class="sc">!=</span> <span class="st">"snpEff_genes.txt"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GeneId,sample) <span class="sc">%&gt;%</span> </span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Mutations =</span> <span class="fu">sum</span>(N)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sample =</span> <span class="fu">str_replace_all</span>(sample,<span class="st">"_"</span>,<span class="st">"-"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>sample)</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>valid_samples <span class="ot">=</span> <span class="fu">inner_join</span>(DNA <span class="sc">%&gt;%</span> </span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>                            dplyr<span class="sc">::</span><span class="fu">select</span>(Sample), </span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>                          RNA <span class="sc">%&gt;%</span> </span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>                            dplyr<span class="sc">::</span><span class="fu">select</span>(Sample)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>DNA_matrix <span class="ot">&lt;-</span> DNA <span class="sc">%&gt;%</span> </span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(valid_samples) <span class="sc">%&gt;%</span> </span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> GeneId, <span class="at">values_from =</span> Mutations) <span class="sc">%&gt;%</span> </span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>RNA_matrix <span class="ot">&lt;-</span> RNA <span class="sc">%&gt;%</span> </span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(valid_samples) <span class="sc">%&gt;%</span> </span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> GeneId, <span class="at">values_from =</span> Expresion) <span class="sc">%&gt;%</span> </span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>table_cor_test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(RNA_matrix)){</span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(DNA_matrix)){</span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>    table_tmp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Mutations =</span> DNA_matrix[,j], <span class="at">Expresion =</span> RNA_matrix[,i])</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>    test <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> Mutations <span class="sc">~</span> Expresion, <span class="at">data =</span> table_tmp) <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">glance</span>()</span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a>    test<span class="sc">$</span>RNA <span class="ot">=</span> <span class="fu">colnames</span>(RNA_matrix[i])</span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a>    test<span class="sc">$</span>DNA <span class="ot">=</span> <span class="fu">colnames</span>(DNA_matrix[j])</span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>    table_cor_test <span class="ot">=</span> <span class="fu">bind_rows</span>(table_cor_test,test)</span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a>table_cor_test <span class="ot">&lt;-</span> table_cor_test <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">p.adj =</span> <span class="fu">p.adjust</span>(p.value, <span class="at">method =</span> <span class="st">"fdr"</span>))</span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true" tabindex="-1"></a>table_cor_test <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p.adj <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-e6787a43152745da3bdf" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e6787a43152745da3bdf">{"x":{"filter":"none","vertical":false,"data":[["1","2"],[0.356365332116608,0.331177599905385],[0.342956276535704,0.318558309337562],[2.81390250728838,2.30697386993604],[26.5764676689171,26.243757374906],[4.74174783547146e-06,4.30252379676604e-06],[1,1],[-121.654992421949,-122.999500253648],[249.309984843898,251.999000507296],[255.046053860182,258.021000062993],[380.066271385143,282.072807138085],[48,53],[50,55],["ENSG00000126070","ENSG00000197915"],["VHL","MPL"],[0.0450466044369789,0.0450466044369789]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>r.squared<\/th>\n      <th>adj.r.squared<\/th>\n      <th>sigma<\/th>\n      <th>statistic<\/th>\n      <th>p.value<\/th>\n      <th>df<\/th>\n      <th>logLik<\/th>\n      <th>AIC<\/th>\n      <th>BIC<\/th>\n      <th>deviance<\/th>\n      <th>df.residual<\/th>\n      <th>nobs<\/th>\n      <th>RNA<\/th>\n      <th>DNA<\/th>\n      <th>p.adj<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,15]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>